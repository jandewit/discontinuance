---
title: "Untitled"
author: "Jan de Wit"
date: "2/23/2022"
output: word_document
---

```{r setup, include=TRUE}
rm(list = ls()) #Clear workspace
knitr::opts_chunk$set(echo = TRUE)

# Disable output of warnings to the generated doc file
# Set to FALSE for final doc, TRUE for debugging
knitr::opts_chunk$set(warning = TRUE)

##### Load packages

# For importing SPSS files
library(foreign)

# Plots
library(ggplot2)

# For filtering
library(dplyr)

# For %>% pipe
library(magrittr)

# For calculating number of days between two dates
library(lubridate)

# For elaborate summary
library(jtools)


##### Load dataset of all waves (not included on Github) and remove missing values

##### Wave 1
data_wave1_in <- read.spss('L_CoronaMelder_wave1_3p.sav', to.data.frame=TRUE, use.missings=FALSE)
# Filter out the respondents that did not complete the entire survey 
data_wave1 <- data_wave1_in[!is.na(data_wave1_in$duur),]
data_wave1['wave'] <- 1

## Calculate mean scores on the different factors
# UTAUT: Performance expectancy
data_wave1$PE1_UTAUTn <- as.numeric(data_wave1$PE1_UTAUT)
data_wave1$PE2_UTAUTn <- as.numeric(data_wave1$PE2_UTAUT)
data_wave1$PE_UTAUT <- rowMeans(data_wave1[, c("PE1_UTAUTn", "PE2_UTAUTn")], na.rm = TRUE)

psy::cronbach(data_wave1[, c("PE1_UTAUTn", "PE2_UTAUTn")])
hist(data_wave1$PE_UTAUT)


# UTAUT: Effort expectancy (users)
data_wave1$EE1a_UTAUTn <- as.numeric(data_wave1$EE1a_UTAUT)
data_wave1$EE2a_UTAUTn <- as.numeric(data_wave1$EE2a_UTAUT)
# Since the item EE2a_UTAUT is positively phrased, it will be reverse coded such that higher numbers refer to higher EE
data_wave1$EE2a_UTAUTn_r = car::recode(data_wave1$EE2a_UTAUTn, '1=7; 2=6; 3=5; 4=4; 5=3; 6=2; 7=1')
data_wave1$EEa_UTAUT <- rowMeans(data_wave1[, c("EE1a_UTAUTn", "EE2a_UTAUTn_r")], na.rm = TRUE)

psy::cronbach(data_wave1[, c("EE1a_UTAUTn", "EE2a_UTAUTn_r")])
hist(data_wave1$EEa_UTAUT)


# UTAUT: Effort expectancy (non-users)
data_wave1$EE1b_UTAUTn <- as.numeric(data_wave1$EE1b_UTAUT)
data_wave1$EE2b_UTAUTn <- as.numeric(data_wave1$EE2b_UTAUT)
# Since the item EE2b_UTAUT is positively phrased, it will be reverse coded such that higher numbers refer to higher EE
data_wave1$EE2b_UTAUTn_r = car::recode(data_wave1$EE2b_UTAUTn, '1=7; 2=6; 3=5; 4=4; 5=3; 6=2; 7=1')
data_wave1$EEb_UTAUT <- rowMeans(data_wave1[, c("EE1b_UTAUTn", "EE2b_UTAUTn_r")], na.rm = TRUE)

psy::cronbach(data_wave1[, c("EE1b_UTAUTn", "EE2b_UTAUTn_r")])
hist(data_wave1$EEb_UTAUT)


# UTAUT: Effort expectancy (total)
data_wave1$EE1_UTAUT <- rowMeans(data_wave1[, c("EE1a_UTAUTn","EE1b_UTAUTn")], na.rm = TRUE)
data_wave1$EE2_UTAUT <- rowMeans(data_wave1[, c("EE2a_UTAUTn_r","EE2b_UTAUTn_r")], na.rm = TRUE)
data_wave1$EE_UTAUT <- rowMeans(data_wave1[, c("EE1_UTAUT", "EE2_UTAUT")], na.rm = TRUE)
psy::cronbach(data_wave1[, c("EE1_UTAUT","EE2_UTAUT")])
hist(data_wave1$EE_UTAUT)


# UTAUT: Social influence
data_wave1$SI1_UTAUTn <- as.numeric(data_wave1$SI1_UTAUT)
data_wave1$SI2_UTAUTn <- as.numeric(data_wave1$SI2_UTAUT)
data_wave1$SI_UTAUT <- rowMeans(data_wave1[, c("SI1_UTAUTn", "SI2_UTAUTn")], na.rm = TRUE)

psy::cronbach(data_wave1[, c("SI1_UTAUTn", "SI2_UTAUTn")])
hist(data_wave1$SI_UTAUT)


# UTAUT: Facilitating conditions
data_wave1$FC1_UTAUTn <- as.numeric(data_wave1$FC1_UTAUT)
data_wave1$FC2_UTAUTn <- as.numeric(data_wave1$FC2_UTAUT)
data_wave1$FC_UTAUT <- rowMeans(data_wave1[, c("FC1_UTAUTn", "FC2_UTAUTn")], na.rm = TRUE)

psy::cronbach(data_wave1[, c("FC1_UTAUTn", "FC2_UTAUTn")])
hist(data_wave1$FC_UTAUT)


# HBM: Perceived susceptibility
data_wave1$HBM_PSus_self1n <- as.numeric(data_wave1$HBM_PSus_self1)
data_wave1$HBM_PSus_self2n <- as.numeric(data_wave1$HBM_PSus_self2)
data_wave1$HBM_PSus_self <- rowMeans(data_wave1[, c("HBM_PSus_self1n", "HBM_PSus_self2n")], na.rm = TRUE)

psy::cronbach(data_wave1[, c("HBM_PSus_self1n", "HBM_PSus_self2n")])
hist(data_wave1$HBM_PSus_self)


# HBM: Perceived severity
data_wave1$HBM_PSev_self1n <- as.numeric(data_wave1$HBM_PSev_self1)
data_wave1$HBM_PSev_self2n <- as.numeric(data_wave1$HBM_PSev_self2)
data_wave1$HBM_PSev_self <- rowMeans(data_wave1[, c("HBM_PSev_self1n", "HBM_PSev_self2n")], na.rm = TRUE)

psy::cronbach(data_wave1[, c("HBM_PSev_self1n", "HBM_PSev_self2n")])
hist(data_wave1$HBM_PSev_self)


# The variables measured from not true - true (5 point scales with 'I don't know as answer options) are recoded, so that 'I don't know' represents the middle value. This should also be recoded, as more data safety is fewer concerns.
data_wave1$Beliefs_datasafetyn <- as.numeric(data_wave1$Beliefs_datasafety)
data_wave1$Beliefs_datasafety_5p <- car::recode(data_wave1$Beliefs_datasafetyn, '1=5; 2=4; 3=2; 4=1; 5=3') 

bla <- data.frame(levels = unique(data_wave1$Beliefs_datasafety), value = as.numeric(unique(data_wave1$Beliefs_datasafety)))

# From Nadine
data_wave1$Beliefs_technologyperformancen <- as.numeric(data_wave1$Beliefs_technologyperformance)
data_wave1$Beliefs_falsesecurity1n <- as.numeric(data_wave1$Beliefs_falsesecurity1)
data_wave1$Beliefs_falsesecurity2n <- as.numeric(data_wave1$Beliefs_falsesecurity2)
data_wave1$Beliefs_technologyperformance_5p <- car::recode(data_wave1$Beliefs_technologyperformancen, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave1$Beliefs_falsesecurity1_5p <- car::recode(data_wave1$Beliefs_falsesecurity1n, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave1$Beliefs_falsesecurity2_5p <- car::recode(data_wave1$Beliefs_falsesecurity2n, '1=1; 2=2; 3=4; 4=5; 5=3') 

unique(data_wave1$CoronaInfectionOther_1)
unique(as.numeric(data_wave1$CoronaInfectionOther_1))

data_wave1 <- data_wave1 %>% mutate(Infectother = case_when( 
  data_wave1$CoronaInfectionOther_1 == 'Ja' | data_wave1$CoronaInfectionOther_2 == 'Ja' | data_wave1$CoronaInfectionOther_3 == 'Ja' | data_wave1$CoronaInfectionOther_4 == 'Ja' | data_wave1$CoronaInfectionOther_5 == 'Ja' | data_wave1$CoronaInfectionOther_6 == 'Ja' ~ 1,
  data_wave1$CoronaInfectionOther_7 == 'Ja' | data_wave1$CoronaInfectionOther_8 == 'Ja' ~ 0))

infectotherprop <- table(data_wave1$Infectother) / length (data_wave1$Infectother)


# Contextual: False security beliefs
#data_wave1$Beliefs_falsesecurity1n <- as.numeric(data_wave1$Beliefs_falsesecurity1)
#data_wave1$Beliefs_falsesecurity2n <- as.numeric(data_wave1$Beliefs_falsesecurity2)
#data_wave1$Beliefs_falsesecurity <- rowMeans(data_wave1[, c("Beliefs_falsesecurity1n", "Beliefs_falsesecurity2n")], na.rm = TRUE)

#psy::cronbach(data_wave1[, c("Beliefs_falsesecurity1n", "Beliefs_falsesecurity2n")])
#hist(data_wave1$Beliefs_falsesecurity)

# Contextual: Societal beliefs
data_wave1$Beliefs_civicdutyn <- as.numeric(data_wave1$Beliefs_civicduty)
data_wave1$Beliefs_benefiteconomicn <- as.numeric(data_wave1$Beliefs_benefiteconomic)
data_wave1$Beliefs_Protectriskgroupsn <- as.numeric(data_wave1$Beliefs_Protectriskgroups)
data_wave1$Beliefs_TrustGovernmentn <- as.numeric(data_wave1$Beliefs_TrustGovernment)
data_wave1$Beliefs_Society <- rowMeans(data_wave1[, c("Beliefs_civicdutyn", "Beliefs_benefiteconomicn", "Beliefs_Protectriskgroupsn", "Beliefs_TrustGovernmentn")], na.rm = TRUE)

psy::cronbach(data_wave1[, c("Beliefs_civicdutyn", "Beliefs_benefiteconomicn", "Beliefs_Protectriskgroupsn", "Beliefs_TrustGovernmentn")])
hist(data_wave1$Beliefs_Society)


# Contextual: Conspiracy beliefs
data_wave1$Beliefs_Conspiracy1n <- as.numeric(data_wave1$Beliefs_Conspiracy1)
data_wave1$Beliefs_Conspiracy2n <- as.numeric(data_wave1$Beliefs_Conspiracy2)

# The variables measured from not true - true (5 point scales with 'I don't know as answer options) are recoded, so that 'I don't know' represents the middle value.
data_wave1$Beliefs_Conspiracy1_5p <- car::recode(data_wave1$Beliefs_Conspiracy1n, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave1$Beliefs_Conspiracy2_5p <- car::recode(data_wave1$Beliefs_Conspiracy2n, '1=1; 2=2; 3=4; 4=5; 5=3') 


data_wave1$Beliefs_Conspiracy <- rowMeans(data_wave1[, c("Beliefs_Conspiracy1_5p", "Beliefs_Conspiracy2_5p")], na.rm = TRUE)

psy::cronbach(data_wave1[, c("Beliefs_Conspiracy1_5p", "Beliefs_Conspiracy2_5p")])
hist(data_wave1$Beliefs_Conspiracy)


# Contextual: Monitoring beliefs
data_wave1$Beliefs_locationmonitoringn <- as.numeric(data_wave1$Beliefs_locationmonitoring)
data_wave1$Beliefs_identitymonitoringn <- as.numeric(data_wave1$Beliefs_identitymonitoring)

# The variables measured from not true - true (5 point scales with 'I don't know as answer options) are recoded, so that 'I don't know' represents the middle value.
data_wave1$Beliefs_locationmonitoring_5p <- car::recode(data_wave1$Beliefs_locationmonitoringn, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave1$Beliefs_identitymonitoring_5p <- car::recode(data_wave1$Beliefs_identitymonitoringn, '1=1; 2=2; 3=4; 4=5; 5=3')

data_wave1$Beliefs_monitoring <- rowMeans(data_wave1[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p")], na.rm = TRUE)

psy::cronbach(data_wave1[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p")])
#psy::cronbach(data_wave1[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p", "Beliefs_datasafety_5p")])
hist(data_wave1$Beliefs_monitoring)


# Contextual: Fear beliefs
data_wave1$Beliefs_fearn <- as.numeric(data_wave1$Beliefs_fear)
data_wave1$Beliefs_notificationfearn <- as.numeric(data_wave1$Beliefs_notificationfear)
data_wave1$Beliefs_fearB <- rowMeans(data_wave1[, c("Beliefs_fearn", "Beliefs_notificationfearn")], na.rm = TRUE)

psy::cronbach(data_wave1[, c("Beliefs_fearn", "Beliefs_notificationfearn")])
hist(data_wave1$Beliefs_fearB)


##### Wave 2
data_wave2_in <- read.spss('L_Corona_app_wave2_3p.sav', to.data.frame=TRUE, use.missings=FALSE)
# Filter out the respondents that did not complete the entire survey 
data_wave2 <- data_wave2_in[!is.na(data_wave2_in$duur),]
data_wave2['wave'] <- 2

## Calculate mean scores on the different factors
# UTAUT: Performance expectancy
data_wave2$PE1_UTAUTn <- as.numeric(data_wave2$PE1_UTAUT)
data_wave2$PE2_UTAUTn <- as.numeric(data_wave2$PE2_UTAUT)
data_wave2$PE_UTAUT <- rowMeans(data_wave2[, c("PE1_UTAUTn", "PE2_UTAUTn")], na.rm = TRUE)

psy::cronbach(data_wave2[, c("PE1_UTAUTn", "PE2_UTAUTn")])
hist(data_wave2$PE_UTAUT)


# UTAUT: Effort expectancy (users)
data_wave2$EE1a_UTAUTn <- as.numeric(data_wave2$EE1a_UTAUT)
data_wave2$EE2a_UTAUTn <- as.numeric(data_wave2$EE2a_UTAUT)
# Since the item EE2a_UTAUT is positively phrased, it will be reverse coded such that higher numbers refer to higher EE
data_wave2$EE2a_UTAUTn_r = car::recode(data_wave2$EE2a_UTAUTn, '1=7; 2=6; 3=5; 4=4; 5=3; 6=2; 7=1')
data_wave2$EEa_UTAUT <- rowMeans(data_wave2[, c("EE1a_UTAUTn", "EE2a_UTAUTn_r")], na.rm = TRUE)

psy::cronbach(data_wave2[, c("EE1a_UTAUTn", "EE2a_UTAUTn_r")])
hist(data_wave2$EEa_UTAUT)


# UTAUT: Effort expectancy (non-users)
data_wave2$EE1b_UTAUTn <- as.numeric(data_wave2$EE1b_UTAUT)
data_wave2$EE2b_UTAUTn <- as.numeric(data_wave2$EE2b_UTAUT)
# Since the item EE2b_UTAUT is positively phrased, it will be reverse coded such that higher numbers refer to higher EE
data_wave2$EE2b_UTAUTn_r = car::recode(data_wave2$EE2b_UTAUTn, '1=7; 2=6; 3=5; 4=4; 5=3; 6=2; 7=1')
data_wave2$EEb_UTAUT <- rowMeans(data_wave2[, c("EE1b_UTAUTn", "EE2b_UTAUTn_r")], na.rm = TRUE)

psy::cronbach(data_wave2[, c("EE1b_UTAUTn", "EE2b_UTAUTn_r")])
hist(data_wave2$EEb_UTAUT)


# UTAUT: Effort expectancy (total)
data_wave2$EE1_UTAUT <- rowMeans(data_wave2[, c("EE1a_UTAUTn","EE1b_UTAUTn")], na.rm = TRUE)
data_wave2$EE2_UTAUT <- rowMeans(data_wave2[, c("EE2a_UTAUTn_r","EE2b_UTAUTn_r")], na.rm = TRUE)
data_wave2$EE_UTAUT <- rowMeans(data_wave2[, c("EE1_UTAUT", "EE2_UTAUT")], na.rm = TRUE)
psy::cronbach(data_wave2[, c("EE1_UTAUT","EE2_UTAUT")])
hist(data_wave2$EE_UTAUT)


# UTAUT: Social influence
data_wave2$SI1_UTAUTn <- as.numeric(data_wave2$SI1_UTAUT)
data_wave2$SI2_UTAUTn <- as.numeric(data_wave2$SI2_UTAUT)
data_wave2$SI_UTAUT <- rowMeans(data_wave2[, c("SI1_UTAUTn", "SI2_UTAUTn")], na.rm = TRUE)

psy::cronbach(data_wave2[, c("SI1_UTAUTn", "SI2_UTAUTn")])
hist(data_wave2$SI_UTAUT)


# UTAUT: Facilitating conditions
data_wave2$FC1_UTAUTn <- as.numeric(data_wave2$FC1_UTAUT)
data_wave2$FC2_UTAUTn <- as.numeric(data_wave2$FC2_UTAUT)
data_wave2$FC_UTAUT <- rowMeans(data_wave2[, c("FC1_UTAUTn", "FC2_UTAUTn")], na.rm = TRUE)

psy::cronbach(data_wave2[, c("FC1_UTAUTn", "FC2_UTAUTn")])
hist(data_wave2$FC_UTAUT)


# HBM: Perceived susceptibility
data_wave2$HBM_PSus_self1n <- as.numeric(data_wave2$HBM_PSus_self1)
data_wave2$HBM_PSus_self2n <- as.numeric(data_wave2$HBM_PSus_self2)
data_wave2$HBM_PSus_self <- rowMeans(data_wave2[, c("HBM_PSus_self1n", "HBM_PSus_self2n")], na.rm = TRUE)

psy::cronbach(data_wave2[, c("HBM_PSus_self1n", "HBM_PSus_self2n")])
hist(data_wave2$HBM_PSus_self)


# HBM: Perceived severity
data_wave2$HBM_PSev_self1n <- as.numeric(data_wave2$HBM_PSev_self1)
data_wave2$HBM_PSev_self2n <- as.numeric(data_wave2$HBM_PSev_self2)
data_wave2$HBM_PSev_self <- rowMeans(data_wave2[, c("HBM_PSev_self1n", "HBM_PSev_self2n")], na.rm = TRUE)

psy::cronbach(data_wave2[, c("HBM_PSev_self1n", "HBM_PSev_self2n")])
hist(data_wave2$HBM_PSev_self)


# The variables measured from not true - true (5 point scales with 'I don't know as answer options) are recoded, so that 'I don't know' represents the middle value. This should also be recoded, as more data safety is fewer concerns.
data_wave2$Beliefs_datasafetyn <- as.numeric(data_wave2$Beliefs_datasafety)
data_wave2$Beliefs_datasafety_5p <- car::recode(data_wave2$Beliefs_datasafetyn, '1=5; 2=4; 3=2; 4=1; 5=3') 

bla <- data.frame(levels = unique(data_wave2$Beliefs_datasafety), value = as.numeric(unique(data_wave2$Beliefs_datasafety)))

# From Nadine
data_wave2$Beliefs_technologyperformancen <- as.numeric(data_wave2$Beliefs_technologyperformance)
data_wave2$Beliefs_falsesecurity1n <- as.numeric(data_wave2$Beliefs_falsesecurity1)
data_wave2$Beliefs_falsesecurity2n <- as.numeric(data_wave2$Beliefs_falsesecurity2)
data_wave2$Beliefs_technologyperformance_5p <- car::recode(data_wave2$Beliefs_technologyperformancen, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave2$Beliefs_falsesecurity1_5p <- car::recode(data_wave2$Beliefs_falsesecurity1n, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave2$Beliefs_falsesecurity2_5p <- car::recode(data_wave2$Beliefs_falsesecurity2n, '1=1; 2=2; 3=4; 4=5; 5=3') 

data_wave2 <- data_wave2 %>% mutate(Infectother = case_when( 
  data_wave2$CoronaInfectionOther_1 == 'Ja' | data_wave2$CoronaInfectionOther_2 == 'Ja' | data_wave2$CoronaInfectionOther_3 == 'Ja' | data_wave2$CoronaInfectionOther_4 == 'Ja' | data_wave2$CoronaInfectionOther_5 == 'Ja' | data_wave2$CoronaInfectionOther_6 == 'Ja' ~ 1,
  data_wave2$CoronaInfectionOther_7 == 'Ja' | data_wave2$CoronaInfectionOther_8 == 'Ja' ~ 0))

infectotherprop <- table(data_wave2$Infectother) / length (data_wave2$Infectother)



# Contextual: False security beliefs
#data_wave2$Beliefs_falsesecurity1n <- as.numeric(data_wave2$Beliefs_falsesecurity1)
#data_wave2$Beliefs_falsesecurity2n <- as.numeric(data_wave2$Beliefs_falsesecurity2)
#data_wave2$Beliefs_falsesecurity <- rowMeans(data_wave2[, c("Beliefs_falsesecurity1n", "Beliefs_falsesecurity2n")], na.rm = TRUE)

#psy::cronbach(data_wave2[, c("Beliefs_falsesecurity1n", "Beliefs_falsesecurity2n")])
#hist(data_wave2$Beliefs_falsesecurity)

# Contextual: Societal beliefs
data_wave2$Beliefs_civicdutyn <- as.numeric(data_wave2$Beliefs_civicduty)
data_wave2$Beliefs_benefiteconomicn <- as.numeric(data_wave2$Beliefs_benefiteconomic)
data_wave2$Beliefs_Protectriskgroupsn <- as.numeric(data_wave2$Beliefs_Protectriskgroups)
data_wave2$Trust_Gov_1n <- as.numeric(data_wave2$Trust_Gov_1)
data_wave2$Trust_Gov_2n <- as.numeric(data_wave2$Trust_Gov_2)
data_wave2$Trust_Gov_3n <- as.numeric(data_wave2$Trust_Gov_3)
data_wave2$Trust_Gov_4n <- as.numeric(data_wave2$Trust_Gov_4)
data_wave2$Trust_Gov_5n <- as.numeric(data_wave2$Trust_Gov_5)
data_wave2$Trust_Gov_6n <- as.numeric(data_wave2$Trust_Gov_6)
data_wave2$Trust_Gov_7n <- as.numeric(data_wave2$Trust_Gov_7)
data_wave2$Beliefs_TrustGovernmentn <- rowMeans(data_wave2[, c("Trust_Gov_1n", "Trust_Gov_2n", "Trust_Gov_3n", "Trust_Gov_4n", "Trust_Gov_5n", "Trust_Gov_6n", "Trust_Gov_7n")])
data_wave2$Beliefs_Society <- rowMeans(data_wave2[, c("Beliefs_civicdutyn", "Beliefs_benefiteconomicn", "Beliefs_Protectriskgroupsn", "Beliefs_TrustGovernmentn")], na.rm = TRUE)

psy::cronbach(data_wave2[, c("Beliefs_civicdutyn", "Beliefs_benefiteconomicn", "Beliefs_Protectriskgroupsn", "Beliefs_TrustGovernmentn")])
hist(data_wave2$Beliefs_Society)


# Contextual: Conspiracy beliefs
data_wave2$Beliefs_Conspiracy1n <- as.numeric(data_wave2$Beliefs_Conspiracy1)
data_wave2$Beliefs_Conspiracy2n <- as.numeric(data_wave2$Beliefs_Conspiracy2)

# The variables measured from not true - true (5 point scales with 'I don't know as answer options) are recoded, so that 'I don't know' represents the middle value.
data_wave2$Beliefs_Conspiracy1_5p <- car::recode(data_wave2$Beliefs_Conspiracy1n, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave2$Beliefs_Conspiracy2_5p <- car::recode(data_wave2$Beliefs_Conspiracy2n, '1=1; 2=2; 3=4; 4=5; 5=3') 


data_wave2$Beliefs_Conspiracy <- rowMeans(data_wave2[, c("Beliefs_Conspiracy1_5p", "Beliefs_Conspiracy2_5p")], na.rm = TRUE)

psy::cronbach(data_wave2[, c("Beliefs_Conspiracy1_5p", "Beliefs_Conspiracy2_5p")])
hist(data_wave2$Beliefs_Conspiracy)


# Contextual: Monitoring beliefs
data_wave2$Beliefs_locationmonitoringn <- as.numeric(data_wave2$Beliefs_locationmonitoring)
data_wave2$Beliefs_identitymonitoringn <- as.numeric(data_wave2$Beliefs_identitymonitoring)

# The variables measured from not true - true (5 point scales with 'I don't know as answer options) are recoded, so that 'I don't know' represents the middle value.
data_wave2$Beliefs_locationmonitoring_5p <- car::recode(data_wave2$Beliefs_locationmonitoringn, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave2$Beliefs_identitymonitoring_5p <- car::recode(data_wave2$Beliefs_identitymonitoringn, '1=1; 2=2; 3=4; 4=5; 5=3')

data_wave2$Beliefs_monitoring <- rowMeans(data_wave2[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p")], na.rm = TRUE)

psy::cronbach(data_wave2[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p")])
#psy::cronbach(data_wave2[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p", "Beliefs_datasafety_5p")])
hist(data_wave2$Beliefs_monitoring)


# Contextual: Fear beliefs
data_wave2$Beliefs_fearn <- as.numeric(data_wave2$Beliefs_fear)
data_wave2$Beliefs_notificationfearn <- as.numeric(data_wave2$Beliefs_notificationfear)
data_wave2$Beliefs_fearB <- rowMeans(data_wave2[, c("Beliefs_fearn", "Beliefs_notificationfearn")], na.rm = TRUE)

psy::cronbach(data_wave2[, c("Beliefs_fearn", "Beliefs_notificationfearn")])
hist(data_wave2$Beliefs_fearB)


##### Wave 3
data_wave3_in <- read.spss('L_Corona_app_wave3_3p.sav', to.data.frame=TRUE, use.missings=FALSE)
# Filter out the respondents that did not complete the entire survey 
data_wave3 <- data_wave3_in[!is.na(data_wave3_in$duur),]
data_wave3['wave'] <- 3

## Calculate mean scores on the different factors
# UTAUT: Performance expectancy
data_wave3$PE1_UTAUTn <- as.numeric(data_wave3$PE1_UTAUT)
data_wave3$PE2_UTAUTn <- as.numeric(data_wave3$PE2_UTAUT)
data_wave3$PE_UTAUT <- rowMeans(data_wave3[, c("PE1_UTAUTn", "PE2_UTAUTn")], na.rm = TRUE)

psy::cronbach(data_wave3[, c("PE1_UTAUTn", "PE2_UTAUTn")])
hist(data_wave3$PE_UTAUT)


# UTAUT: Effort expectancy (users)
data_wave3$EE1a_UTAUTn <- as.numeric(data_wave3$EE1a_UTAUT)
data_wave3$EE2a_UTAUTn <- as.numeric(data_wave3$EE2a_UTAUT)
# Since the item EE2a_UTAUT is positively phrased, it will be reverse coded such that higher numbers refer to higher EE
data_wave3$EE2a_UTAUTn_r = car::recode(data_wave3$EE2a_UTAUTn, '1=7; 2=6; 3=5; 4=4; 5=3; 6=2; 7=1')
data_wave3$EEa_UTAUT <- rowMeans(data_wave3[, c("EE1a_UTAUTn", "EE2a_UTAUTn_r")], na.rm = TRUE)

psy::cronbach(data_wave3[, c("EE1a_UTAUTn", "EE2a_UTAUTn_r")])
hist(data_wave3$EEa_UTAUT)


# UTAUT: Effort expectancy (non-users)
data_wave3$EE1b_UTAUTn <- as.numeric(data_wave3$EE1b_UTAUT)
data_wave3$EE2b_UTAUTn <- as.numeric(data_wave3$EE2b_UTAUT)
# Since the item EE2b_UTAUT is positively phrased, it will be reverse coded such that higher numbers refer to higher EE
data_wave3$EE2b_UTAUTn_r = car::recode(data_wave3$EE2b_UTAUTn, '1=7; 2=6; 3=5; 4=4; 5=3; 6=2; 7=1')
data_wave3$EEb_UTAUT <- rowMeans(data_wave3[, c("EE1b_UTAUTn", "EE2b_UTAUTn_r")], na.rm = TRUE)

psy::cronbach(data_wave3[, c("EE1b_UTAUTn", "EE2b_UTAUTn_r")])
hist(data_wave3$EEb_UTAUT)


# UTAUT: Effort expectancy (total)
data_wave3$EE1_UTAUT <- rowMeans(data_wave3[, c("EE1a_UTAUTn","EE1b_UTAUTn")], na.rm = TRUE)
data_wave3$EE2_UTAUT <- rowMeans(data_wave3[, c("EE2a_UTAUTn_r","EE2b_UTAUTn_r")], na.rm = TRUE)
data_wave3$EE_UTAUT <- rowMeans(data_wave3[, c("EE1_UTAUT", "EE2_UTAUT")], na.rm = TRUE)
psy::cronbach(data_wave3[, c("EE1_UTAUT","EE2_UTAUT")])
hist(data_wave3$EE_UTAUT)


# UTAUT: Social influence
data_wave3$SI1_UTAUTn <- as.numeric(data_wave3$SI1_UTAUT)
data_wave3$SI2_UTAUTn <- as.numeric(data_wave3$SI2_UTAUT)
data_wave3$SI_UTAUT <- rowMeans(data_wave3[, c("SI1_UTAUTn", "SI2_UTAUTn")], na.rm = TRUE)

psy::cronbach(data_wave3[, c("SI1_UTAUTn", "SI2_UTAUTn")])
hist(data_wave3$SI_UTAUT)


# UTAUT: Facilitating conditions
data_wave3$FC1_UTAUTn <- as.numeric(data_wave3$FC1_UTAUT)
data_wave3$FC2_UTAUTn <- as.numeric(data_wave3$FC2_UTAUT)
data_wave3$FC_UTAUT <- rowMeans(data_wave3[, c("FC1_UTAUTn", "FC2_UTAUTn")], na.rm = TRUE)

psy::cronbach(data_wave3[, c("FC1_UTAUTn", "FC2_UTAUTn")])
hist(data_wave3$FC_UTAUT)


# HBM: Perceived susceptibility
data_wave3$HBM_PSus_self1n <- as.numeric(data_wave3$HBM_PSus_self1)
data_wave3$HBM_PSus_self2n <- as.numeric(data_wave3$HBM_PSus_self2)
data_wave3$HBM_PSus_self <- rowMeans(data_wave3[, c("HBM_PSus_self1n", "HBM_PSus_self2n")], na.rm = TRUE)

psy::cronbach(data_wave3[, c("HBM_PSus_self1n", "HBM_PSus_self2n")])
hist(data_wave3$HBM_PSus_self)


# HBM: Perceived severity
data_wave3$HBM_PSev_self1n <- as.numeric(data_wave3$HBM_PSev_self1)
data_wave3$HBM_PSev_self2n <- as.numeric(data_wave3$HBM_PSev_self2)
data_wave3$HBM_PSev_self <- rowMeans(data_wave3[, c("HBM_PSev_self1n", "HBM_PSev_self2n")], na.rm = TRUE)

psy::cronbach(data_wave3[, c("HBM_PSev_self1n", "HBM_PSev_self2n")])
hist(data_wave3$HBM_PSev_self)


# The variables measured from not true - true (5 point scales with 'I don't know as answer options) are recoded, so that 'I don't know' represents the middle value. This should also be recoded, as more data safety is fewer concerns.
data_wave3$Beliefs_datasafetyn <- as.numeric(data_wave3$Beliefs_datasafety)
data_wave3$Beliefs_datasafety_5p <- car::recode(data_wave3$Beliefs_datasafetyn, '1=5; 2=4; 3=2; 4=1; 5=3') 

bla <- data.frame(levels = unique(data_wave3$Beliefs_datasafety), value = as.numeric(unique(data_wave3$Beliefs_datasafety)))

# From Nadine
data_wave3$Beliefs_technologyperformancen <- as.numeric(data_wave3$Beliefs_technologyperformance)
data_wave3$Beliefs_falsesecurity1n <- as.numeric(data_wave3$Beliefs_falsesecurity1)
data_wave3$Beliefs_falsesecurity2n <- as.numeric(data_wave3$Beliefs_falsesecurity2)
data_wave3$Beliefs_technologyperformance_5p <- car::recode(data_wave3$Beliefs_technologyperformancen, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave3$Beliefs_falsesecurity1_5p <- car::recode(data_wave3$Beliefs_falsesecurity1n, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave3$Beliefs_falsesecurity2_5p <- car::recode(data_wave3$Beliefs_falsesecurity2n, '1=1; 2=2; 3=4; 4=5; 5=3') 

data_wave3 <- data_wave3 %>% mutate(Infectother = case_when( 
  data_wave3$CoronaInfectionOther_1 == 'Ja' | data_wave3$CoronaInfectionOther_2 == 'Ja' | data_wave3$CoronaInfectionOther_3 == 'Ja' | data_wave3$CoronaInfectionOther_4 == 'Ja' | data_wave3$CoronaInfectionOther_5 == 'Ja' | data_wave3$CoronaInfectionOther_6 == 'Ja' ~ 1,
  data_wave3$CoronaInfectionOther_7 == 'Ja' | data_wave3$CoronaInfectionOther_8 == 'Ja' ~ 0))

infectotherprop <- table(data_wave3$Infectother) / length (data_wave3$Infectother)



# Contextual: False security beliefs
#data_wave3$Beliefs_falsesecurity1n <- as.numeric(data_wave3$Beliefs_falsesecurity1)
#data_wave3$Beliefs_falsesecurity2n <- as.numeric(data_wave3$Beliefs_falsesecurity2)
#data_wave3$Beliefs_falsesecurity <- rowMeans(data_wave3[, c("Beliefs_falsesecurity1n", "Beliefs_falsesecurity2n")], na.rm = TRUE)

#psy::cronbach(data_wave3[, c("Beliefs_falsesecurity1n", "Beliefs_falsesecurity2n")])
#hist(data_wave3$Beliefs_falsesecurity)

# Contextual: Societal beliefs
data_wave3$Beliefs_civicdutyn <- as.numeric(data_wave3$Beliefs_civicduty)
data_wave3$Beliefs_benefiteconomicn <- as.numeric(data_wave3$Beliefs_benefiteconomic)
data_wave3$Beliefs_Protectriskgroupsn <- as.numeric(data_wave3$Beliefs_Protectriskgroups)
data_wave3$Beliefs_TrustGovernmentn <- as.numeric(data_wave3$Beliefs_TrustGovernment)
data_wave3$Beliefs_Society <- rowMeans(data_wave3[, c("Beliefs_civicdutyn", "Beliefs_benefiteconomicn", "Beliefs_Protectriskgroupsn", "Beliefs_TrustGovernmentn")], na.rm = TRUE)

psy::cronbach(data_wave3[, c("Beliefs_civicdutyn", "Beliefs_benefiteconomicn", "Beliefs_Protectriskgroupsn", "Beliefs_TrustGovernmentn")])
hist(data_wave3$Beliefs_Society)


# Contextual: Conspiracy beliefs
data_wave3$Beliefs_Conspiracy1n <- as.numeric(data_wave3$Beliefs_Conspiracy1)
data_wave3$Beliefs_Conspiracy2n <- as.numeric(data_wave3$Beliefs_Conspiracy2)

# The variables measured from not true - true (5 point scales with 'I don't know as answer options) are recoded, so that 'I don't know' represents the middle value.
data_wave3$Beliefs_Conspiracy1_5p <- car::recode(data_wave3$Beliefs_Conspiracy1n, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave3$Beliefs_Conspiracy2_5p <- car::recode(data_wave3$Beliefs_Conspiracy2n, '1=1; 2=2; 3=4; 4=5; 5=3') 


data_wave3$Beliefs_Conspiracy <- rowMeans(data_wave3[, c("Beliefs_Conspiracy1_5p", "Beliefs_Conspiracy2_5p")], na.rm = TRUE)

psy::cronbach(data_wave3[, c("Beliefs_Conspiracy1_5p", "Beliefs_Conspiracy2_5p")])
hist(data_wave3$Beliefs_Conspiracy)


# Contextual: Monitoring beliefs
data_wave3$Beliefs_locationmonitoringn <- as.numeric(data_wave3$Beliefs_locationmonitoring)
data_wave3$Beliefs_identitymonitoringn <- as.numeric(data_wave3$Beliefs_identitymonitoring)

# The variables measured from not true - true (5 point scales with 'I don't know as answer options) are recoded, so that 'I don't know' represents the middle value.
data_wave3$Beliefs_locationmonitoring_5p <- car::recode(data_wave3$Beliefs_locationmonitoringn, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave3$Beliefs_identitymonitoring_5p <- car::recode(data_wave3$Beliefs_identitymonitoringn, '1=1; 2=2; 3=4; 4=5; 5=3')

data_wave3$Beliefs_monitoring <- rowMeans(data_wave3[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p")], na.rm = TRUE)

psy::cronbach(data_wave3[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p")])
#psy::cronbach(data_wave3[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p", "Beliefs_datasafety_5p")])
hist(data_wave3$Beliefs_monitoring)


# Contextual: Fear beliefs
data_wave3$Beliefs_fearn <- as.numeric(data_wave3$Beliefs_fear)
data_wave3$Beliefs_notificationfearn <- as.numeric(data_wave3$Beliefs_notificationfear)
data_wave3$Beliefs_fearB <- rowMeans(data_wave3[, c("Beliefs_fearn", "Beliefs_notificationfearn")], na.rm = TRUE)

psy::cronbach(data_wave3[, c("Beliefs_fearn", "Beliefs_notificationfearn")])
hist(data_wave3$Beliefs_fearB)


##### Wave 4
data_wave4_in <- read.spss('L_Corona_app_wave4_3p.sav', to.data.frame=TRUE, use.missings=FALSE)
# Filter out the respondents that did not complete the entire survey 
data_wave4 <- data_wave4_in[!is.na(data_wave4_in$duur),]
data_wave4['wave'] <- 4

## Calculate mean scores on the different factors
# UTAUT: Performance expectancy
data_wave4$PE1_UTAUTn <- as.numeric(data_wave4$PE1_UTAUT)
data_wave4$PE2_UTAUTn <- as.numeric(data_wave4$PE2_UTAUT)
data_wave4$PE_UTAUT <- rowMeans(data_wave4[, c("PE1_UTAUTn", "PE2_UTAUTn")], na.rm = TRUE)

psy::cronbach(data_wave4[, c("PE1_UTAUTn", "PE2_UTAUTn")])
hist(data_wave4$PE_UTAUT)


# UTAUT: Effort expectancy (users)
data_wave4$EE1a_UTAUTn <- as.numeric(data_wave4$EE1a_UTAUT)
data_wave4$EE2a_UTAUTn <- as.numeric(data_wave4$EE2a_UTAUT)
# Since the item EE2a_UTAUT is positively phrased, it will be reverse coded such that higher numbers refer to higher EE
data_wave4$EE2a_UTAUTn_r = car::recode(data_wave4$EE2a_UTAUTn, '1=7; 2=6; 3=5; 4=4; 5=3; 6=2; 7=1')
data_wave4$EEa_UTAUT <- rowMeans(data_wave4[, c("EE1a_UTAUTn", "EE2a_UTAUTn_r")], na.rm = TRUE)

psy::cronbach(data_wave4[, c("EE1a_UTAUTn", "EE2a_UTAUTn_r")])
hist(data_wave4$EEa_UTAUT)


# UTAUT: Effort expectancy (non-users)
data_wave4$EE1b_UTAUTn <- as.numeric(data_wave4$EE1b_UTAUT)
data_wave4$EE2b_UTAUTn <- as.numeric(data_wave4$EE2b_UTAUT)
# Since the item EE2b_UTAUT is positively phrased, it will be reverse coded such that higher numbers refer to higher EE
data_wave4$EE2b_UTAUTn_r = car::recode(data_wave4$EE2b_UTAUTn, '1=7; 2=6; 3=5; 4=4; 5=3; 6=2; 7=1')
data_wave4$EEb_UTAUT <- rowMeans(data_wave4[, c("EE1b_UTAUTn", "EE2b_UTAUTn_r")], na.rm = TRUE)

psy::cronbach(data_wave4[, c("EE1b_UTAUTn", "EE2b_UTAUTn_r")])
hist(data_wave4$EEb_UTAUT)


# UTAUT: Effort expectancy (total)
data_wave4$EE1_UTAUT <- rowMeans(data_wave4[, c("EE1a_UTAUTn","EE1b_UTAUTn")], na.rm = TRUE)
data_wave4$EE2_UTAUT <- rowMeans(data_wave4[, c("EE2a_UTAUTn_r","EE2b_UTAUTn_r")], na.rm = TRUE)
data_wave4$EE_UTAUT <- rowMeans(data_wave4[, c("EE1_UTAUT", "EE2_UTAUT")], na.rm = TRUE)
psy::cronbach(data_wave4[, c("EE1_UTAUT","EE2_UTAUT")])
hist(data_wave4$EE_UTAUT)


# UTAUT: Social influence
data_wave4$SI1_UTAUTn <- as.numeric(data_wave4$SI1_UTAUT)
data_wave4$SI2_UTAUTn <- as.numeric(data_wave4$SI2_UTAUT)
data_wave4$SI_UTAUT <- rowMeans(data_wave4[, c("SI1_UTAUTn", "SI2_UTAUTn")], na.rm = TRUE)

psy::cronbach(data_wave4[, c("SI1_UTAUTn", "SI2_UTAUTn")])
hist(data_wave4$SI_UTAUT)


# UTAUT: Facilitating conditions
data_wave4$FC1_UTAUTn <- as.numeric(data_wave4$FC1_UTAUT)
data_wave4$FC2_UTAUTn <- as.numeric(data_wave4$FC2_UTAUT)
data_wave4$FC_UTAUT <- rowMeans(data_wave4[, c("FC1_UTAUTn", "FC2_UTAUTn")], na.rm = TRUE)

psy::cronbach(data_wave4[, c("FC1_UTAUTn", "FC2_UTAUTn")])
hist(data_wave4$FC_UTAUT)


# HBM: Perceived susceptibility
data_wave4$HBM_PSus_self1n <- as.numeric(data_wave4$HBM_PSus_self1)
data_wave4$HBM_PSus_self2n <- as.numeric(data_wave4$HBM_PSus_self2)
data_wave4$HBM_PSus_self <- rowMeans(data_wave4[, c("HBM_PSus_self1n", "HBM_PSus_self2n")], na.rm = TRUE)

psy::cronbach(data_wave4[, c("HBM_PSus_self1n", "HBM_PSus_self2n")])
hist(data_wave4$HBM_PSus_self)


# HBM: Perceived severity
data_wave4$HBM_PSev_self1n <- as.numeric(data_wave4$HBM_PSev_self1)
data_wave4$HBM_PSev_self2n <- as.numeric(data_wave4$HBM_PSev_self2)
data_wave4$HBM_PSev_self <- rowMeans(data_wave4[, c("HBM_PSev_self1n", "HBM_PSev_self2n")], na.rm = TRUE)

psy::cronbach(data_wave4[, c("HBM_PSev_self1n", "HBM_PSev_self2n")])
hist(data_wave4$HBM_PSev_self)


# The variables measured from not true - true (5 point scales with 'I don't know as answer options) are recoded, so that 'I don't know' represents the middle value. This should also be recoded, as more data safety is fewer concerns.
data_wave4$Beliefs_datasafetyn <- as.numeric(data_wave4$Beliefs_datasafety)
data_wave4$Beliefs_datasafety_5p <- car::recode(data_wave4$Beliefs_datasafetyn, '1=5; 2=4; 3=2; 4=1; 5=3') 

bla <- data.frame(levels = unique(data_wave4$Beliefs_datasafety), value = as.numeric(unique(data_wave4$Beliefs_datasafety)))

# From Nadine
data_wave4$Beliefs_technologyperformancen <- as.numeric(data_wave4$Beliefs_technologyperformance)
data_wave4$Beliefs_falsesecurity1n <- as.numeric(data_wave4$Beliefs_falsesecurity1)
data_wave4$Beliefs_falsesecurity2n <- as.numeric(data_wave4$Beliefs_falsesecurity2)
data_wave4$Beliefs_technologyperformance_5p <- car::recode(data_wave4$Beliefs_technologyperformancen, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave4$Beliefs_falsesecurity1_5p <- car::recode(data_wave4$Beliefs_falsesecurity1n, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave4$Beliefs_falsesecurity2_5p <- car::recode(data_wave4$Beliefs_falsesecurity2n, '1=1; 2=2; 3=4; 4=5; 5=3') 

data_wave4 <- data_wave4 %>% mutate(Infectother = case_when( 
  data_wave4$CoronaInfectionOther_1 == 'Ja' | data_wave4$CoronaInfectionOther_2 == 'Ja' | data_wave4$CoronaInfectionOther_3 == 'Ja' | data_wave4$CoronaInfectionOther_4 == 'Ja' | data_wave4$CoronaInfectionOther_5 == 'Ja' | data_wave4$CoronaInfectionOther_6 == 'Ja' ~ 1,
  data_wave4$CoronaInfectionOther_7 == 'Ja' | data_wave4$CoronaInfectionOther_8 == 'Ja' ~ 0))

infectotherprop <- table(data_wave4$Infectother) / length (data_wave4$Infectother)



# Contextual: False security beliefs
#data_wave4$Beliefs_falsesecurity1n <- as.numeric(data_wave4$Beliefs_falsesecurity1)
#data_wave4$Beliefs_falsesecurity2n <- as.numeric(data_wave4$Beliefs_falsesecurity2)
#data_wave4$Beliefs_falsesecurity <- rowMeans(data_wave4[, c("Beliefs_falsesecurity1n", "Beliefs_falsesecurity2n")], na.rm = TRUE)

#psy::cronbach(data_wave4[, c("Beliefs_falsesecurity1n", "Beliefs_falsesecurity2n")])
#hist(data_wave4$Beliefs_falsesecurity)

# Contextual: Societal beliefs
data_wave4$Beliefs_civicdutyn <- as.numeric(data_wave4$Beliefs_civicduty)
data_wave4$Beliefs_benefiteconomicn <- as.numeric(data_wave4$Beliefs_benefiteconomic)
data_wave4$Beliefs_Protectriskgroupsn <- as.numeric(data_wave4$Beliefs_Protectriskgroups)
data_wave4$Beliefs_TrustGovernmentn <- as.numeric(data_wave4$Beliefs_TrustGovernment)
data_wave4$Beliefs_Society <- rowMeans(data_wave4[, c("Beliefs_civicdutyn", "Beliefs_benefiteconomicn", "Beliefs_Protectriskgroupsn", "Beliefs_TrustGovernmentn")], na.rm = TRUE)

psy::cronbach(data_wave4[, c("Beliefs_civicdutyn", "Beliefs_benefiteconomicn", "Beliefs_Protectriskgroupsn", "Beliefs_TrustGovernmentn")])
hist(data_wave4$Beliefs_Society)


# Contextual: Conspiracy beliefs
data_wave4$Beliefs_Conspiracy1n <- as.numeric(data_wave4$Beliefs_Conspiracy1)
data_wave4$Beliefs_Conspiracy2n <- as.numeric(data_wave4$Beliefs_Conspiracy2)

# The variables measured from not true - true (5 point scales with 'I don't know as answer options) are recoded, so that 'I don't know' represents the middle value.
data_wave4$Beliefs_Conspiracy1_5p <- car::recode(data_wave4$Beliefs_Conspiracy1n, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave4$Beliefs_Conspiracy2_5p <- car::recode(data_wave4$Beliefs_Conspiracy2n, '1=1; 2=2; 3=4; 4=5; 5=3') 


data_wave4$Beliefs_Conspiracy <- rowMeans(data_wave4[, c("Beliefs_Conspiracy1_5p", "Beliefs_Conspiracy2_5p")], na.rm = TRUE)

psy::cronbach(data_wave4[, c("Beliefs_Conspiracy1_5p", "Beliefs_Conspiracy2_5p")])
hist(data_wave4$Beliefs_Conspiracy)


# Contextual: Monitoring beliefs
data_wave4$Beliefs_locationmonitoringn <- as.numeric(data_wave4$Beliefs_locationmonitoring)
data_wave4$Beliefs_identitymonitoringn <- as.numeric(data_wave4$Beliefs_identitymonitoring)

# The variables measured from not true - true (5 point scales with 'I don't know as answer options) are recoded, so that 'I don't know' represents the middle value.
data_wave4$Beliefs_locationmonitoring_5p <- car::recode(data_wave4$Beliefs_locationmonitoringn, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave4$Beliefs_identitymonitoring_5p <- car::recode(data_wave4$Beliefs_identitymonitoringn, '1=1; 2=2; 3=4; 4=5; 5=3')

data_wave4$Beliefs_monitoring <- rowMeans(data_wave4[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p")], na.rm = TRUE)

psy::cronbach(data_wave4[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p")])
#psy::cronbach(data_wave4[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p", "Beliefs_datasafety_5p")])
hist(data_wave4$Beliefs_monitoring)


# Contextual: Fear beliefs
data_wave4$Beliefs_fearn <- as.numeric(data_wave4$Beliefs_fear)
data_wave4$Beliefs_notificationfearn <- as.numeric(data_wave4$Beliefs_notificationfear)
data_wave4$Beliefs_fearB <- rowMeans(data_wave4[, c("Beliefs_fearn", "Beliefs_notificationfearn")], na.rm = TRUE)

psy::cronbach(data_wave4[, c("Beliefs_fearn", "Beliefs_notificationfearn")])
hist(data_wave4$Beliefs_fearB)


##### Wave 5
data_wave5_in <- read.spss('L_Corona_app_wave5_3p.sav', to.data.frame=TRUE, use.missings=FALSE)
# Filter out the respondents that did not complete the entire survey 
data_wave5 <- data_wave5_in[!is.na(data_wave5_in$duur),]
data_wave5['wave'] <- 5

## Calculate mean scores on the different factors
# UTAUT: Performance expectancy
data_wave5$PE1_UTAUTn <- as.numeric(data_wave5$PE1_UTAUT)
data_wave5$PE2_UTAUTn <- as.numeric(data_wave5$PE2_UTAUT)
data_wave5$PE_UTAUT <- rowMeans(data_wave5[, c("PE1_UTAUTn", "PE2_UTAUTn")], na.rm = TRUE)

psy::cronbach(data_wave5[, c("PE1_UTAUTn", "PE2_UTAUTn")])
hist(data_wave5$PE_UTAUT)


# UTAUT: Effort expectancy (users)
data_wave5$EE1a_UTAUTn <- as.numeric(data_wave5$EE1a_UTAUT)
data_wave5$EE2a_UTAUTn <- as.numeric(data_wave5$EE2a_UTAUT)
# Since the item EE2a_UTAUT is positively phrased, it will be reverse coded such that higher numbers refer to higher EE
data_wave5$EE2a_UTAUTn_r = car::recode(data_wave5$EE2a_UTAUTn, '1=7; 2=6; 3=5; 4=4; 5=3; 6=2; 7=1')
data_wave5$EEa_UTAUT <- rowMeans(data_wave5[, c("EE1a_UTAUTn", "EE2a_UTAUTn_r")], na.rm = TRUE)

psy::cronbach(data_wave5[, c("EE1a_UTAUTn", "EE2a_UTAUTn_r")])
hist(data_wave5$EEa_UTAUT)


# UTAUT: Effort expectancy (non-users)
data_wave5$EE1b_UTAUTn <- as.numeric(data_wave5$EE1b_UTAUT)
data_wave5$EE2b_UTAUTn <- as.numeric(data_wave5$EE2b_UTAUT)
# Since the item EE2b_UTAUT is positively phrased, it will be reverse coded such that higher numbers refer to higher EE
data_wave5$EE2b_UTAUTn_r = car::recode(data_wave5$EE2b_UTAUTn, '1=7; 2=6; 3=5; 4=4; 5=3; 6=2; 7=1')
data_wave5$EEb_UTAUT <- rowMeans(data_wave5[, c("EE1b_UTAUTn", "EE2b_UTAUTn_r")], na.rm = TRUE)

psy::cronbach(data_wave5[, c("EE1b_UTAUTn", "EE2b_UTAUTn_r")])
hist(data_wave5$EEb_UTAUT)


# UTAUT: Effort expectancy (total)
data_wave5$EE1_UTAUT <- rowMeans(data_wave5[, c("EE1a_UTAUTn","EE1b_UTAUTn")], na.rm = TRUE)
data_wave5$EE2_UTAUT <- rowMeans(data_wave5[, c("EE2a_UTAUTn_r","EE2b_UTAUTn_r")], na.rm = TRUE)
data_wave5$EE_UTAUT <- rowMeans(data_wave5[, c("EE1_UTAUT", "EE2_UTAUT")], na.rm = TRUE)
psy::cronbach(data_wave5[, c("EE1_UTAUT","EE2_UTAUT")])
hist(data_wave5$EE_UTAUT)


# UTAUT: Social influence
data_wave5$SI1_UTAUTn <- as.numeric(data_wave5$SI1_UTAUT)
data_wave5$SI2_UTAUTn <- as.numeric(data_wave5$SI2_UTAUT)
data_wave5$SI_UTAUT <- rowMeans(data_wave5[, c("SI1_UTAUTn", "SI2_UTAUTn")], na.rm = TRUE)

psy::cronbach(data_wave5[, c("SI1_UTAUTn", "SI2_UTAUTn")])
hist(data_wave5$SI_UTAUT)


# UTAUT: Facilitating conditions
data_wave5$FC1_UTAUTn <- as.numeric(data_wave5$FC1_UTAUT)
data_wave5$FC2_UTAUTn <- as.numeric(data_wave5$FC2_UTAUT)
data_wave5$FC_UTAUT <- rowMeans(data_wave5[, c("FC1_UTAUTn", "FC2_UTAUTn")], na.rm = TRUE)

psy::cronbach(data_wave5[, c("FC1_UTAUTn", "FC2_UTAUTn")])
hist(data_wave5$FC_UTAUT)


# HBM: Perceived susceptibility
data_wave5$HBM_PSus_self1n <- as.numeric(data_wave5$HBM_PSus_self1)
data_wave5$HBM_PSus_self2n <- as.numeric(data_wave5$HBM_PSus_self2)
data_wave5$HBM_PSus_self <- rowMeans(data_wave5[, c("HBM_PSus_self1n", "HBM_PSus_self2n")], na.rm = TRUE)

psy::cronbach(data_wave5[, c("HBM_PSus_self1n", "HBM_PSus_self2n")])
hist(data_wave5$HBM_PSus_self)


# HBM: Perceived severity
data_wave5$HBM_PSev_self1n <- as.numeric(data_wave5$HBM_PSev_self1)
data_wave5$HBM_PSev_self2n <- as.numeric(data_wave5$HBM_PSev_self2)
data_wave5$HBM_PSev_self <- rowMeans(data_wave5[, c("HBM_PSev_self1n", "HBM_PSev_self2n")], na.rm = TRUE)

psy::cronbach(data_wave5[, c("HBM_PSev_self1n", "HBM_PSev_self2n")])
hist(data_wave5$HBM_PSev_self)


# The variables measured from not true - true (5 point scales with 'I don't know as answer options) are recoded, so that 'I don't know' represents the middle value. This should also be recoded, as more data safety is fewer concerns.
data_wave5$Beliefs_datasafetyn <- as.numeric(data_wave5$Beliefs_datasafety)
data_wave5$Beliefs_datasafety_5p <- car::recode(data_wave5$Beliefs_datasafetyn, '1=5; 2=4; 3=2; 4=1; 5=3') 

bla <- data.frame(levels = unique(data_wave5$Beliefs_datasafety), value = as.numeric(unique(data_wave5$Beliefs_datasafety)))

# From Nadine
data_wave5$Beliefs_technologyperformancen <- as.numeric(data_wave5$Beliefs_technologyperformance)
data_wave5$Beliefs_falsesecurity1n <- as.numeric(data_wave5$Beliefs_falsesecurity1)
data_wave5$Beliefs_falsesecurity2n <- as.numeric(data_wave5$Beliefs_falsesecurity2)
data_wave5$Beliefs_technologyperformance_5p <- car::recode(data_wave5$Beliefs_technologyperformancen, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave5$Beliefs_falsesecurity1_5p <- car::recode(data_wave5$Beliefs_falsesecurity1n, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave5$Beliefs_falsesecurity2_5p <- car::recode(data_wave5$Beliefs_falsesecurity2n, '1=1; 2=2; 3=4; 4=5; 5=3') 

data_wave5 <- data_wave5 %>% mutate(Infectother = case_when( 
  data_wave5$CoronaInfectionOther_1 == 'Ja' | data_wave5$CoronaInfectionOther_2 == 'Ja' | data_wave5$CoronaInfectionOther_3 == 'Ja' | data_wave5$CoronaInfectionOther_4 == 'Ja' | data_wave5$CoronaInfectionOther_5 == 'Ja' | data_wave5$CoronaInfectionOther_6 == 'Ja' ~ 1,
  data_wave5$CoronaInfectionOther_7 == 'Ja' | data_wave5$CoronaInfectionOther_8 == 'Ja' ~ 0))

infectotherprop <- table(data_wave5$Infectother) / length (data_wave5$Infectother)



# Contextual: False security beliefs
#data_wave5$Beliefs_falsesecurity1n <- as.numeric(data_wave5$Beliefs_falsesecurity1)
#data_wave5$Beliefs_falsesecurity2n <- as.numeric(data_wave5$Beliefs_falsesecurity2)
#data_wave5$Beliefs_falsesecurity <- rowMeans(data_wave5[, c("Beliefs_falsesecurity1n", "Beliefs_falsesecurity2n")], na.rm = TRUE)

#psy::cronbach(data_wave5[, c("Beliefs_falsesecurity1n", "Beliefs_falsesecurity2n")])
#hist(data_wave5$Beliefs_falsesecurity)

# Contextual: Societal beliefs
data_wave5$Beliefs_civicdutyn <- as.numeric(data_wave5$Beliefs_civicduty)
data_wave5$Beliefs_benefiteconomicn <- as.numeric(data_wave5$Beliefs_benefiteconomic)
data_wave5$Beliefs_Protectriskgroupsn <- as.numeric(data_wave5$Beliefs_Protectriskgroups)
data_wave5$Beliefs_TrustGovernmentn <- as.numeric(data_wave5$Beliefs_TrustGovernment)
data_wave5$Beliefs_Society <- rowMeans(data_wave5[, c("Beliefs_civicdutyn", "Beliefs_benefiteconomicn", "Beliefs_Protectriskgroupsn", "Beliefs_TrustGovernmentn")], na.rm = TRUE)

psy::cronbach(data_wave5[, c("Beliefs_civicdutyn", "Beliefs_benefiteconomicn", "Beliefs_Protectriskgroupsn", "Beliefs_TrustGovernmentn")])
hist(data_wave5$Beliefs_Society)


# Contextual: Conspiracy beliefs
data_wave5$Beliefs_Conspiracy1n <- as.numeric(data_wave5$Beliefs_Conspiracy1)
data_wave5$Beliefs_Conspiracy2n <- as.numeric(data_wave5$Beliefs_Conspiracy2)

# The variables measured from not true - true (5 point scales with 'I don't know as answer options) are recoded, so that 'I don't know' represents the middle value.
data_wave5$Beliefs_Conspiracy1_5p <- car::recode(data_wave5$Beliefs_Conspiracy1n, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave5$Beliefs_Conspiracy2_5p <- car::recode(data_wave5$Beliefs_Conspiracy2n, '1=1; 2=2; 3=4; 4=5; 5=3') 


data_wave5$Beliefs_Conspiracy <- rowMeans(data_wave5[, c("Beliefs_Conspiracy1_5p", "Beliefs_Conspiracy2_5p")], na.rm = TRUE)

psy::cronbach(data_wave5[, c("Beliefs_Conspiracy1_5p", "Beliefs_Conspiracy2_5p")])
hist(data_wave5$Beliefs_Conspiracy)


# Contextual: Monitoring beliefs
data_wave5$Beliefs_locationmonitoringn <- as.numeric(data_wave5$Beliefs_locationmonitoring)
data_wave5$Beliefs_identitymonitoringn <- as.numeric(data_wave5$Beliefs_identitymonitoring)

# The variables measured from not true - true (5 point scales with 'I don't know as answer options) are recoded, so that 'I don't know' represents the middle value.
data_wave5$Beliefs_locationmonitoring_5p <- car::recode(data_wave5$Beliefs_locationmonitoringn, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave5$Beliefs_identitymonitoring_5p <- car::recode(data_wave5$Beliefs_identitymonitoringn, '1=1; 2=2; 3=4; 4=5; 5=3')

data_wave5$Beliefs_monitoring <- rowMeans(data_wave5[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p")], na.rm = TRUE)

psy::cronbach(data_wave5[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p")])
#psy::cronbach(data_wave5[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p", "Beliefs_datasafety_5p")])
hist(data_wave5$Beliefs_monitoring)


# Contextual: Fear beliefs
data_wave5$Beliefs_fearn <- as.numeric(data_wave5$Beliefs_fear)
data_wave5$Beliefs_notificationfearn <- as.numeric(data_wave5$Beliefs_notificationfear)
data_wave5$Beliefs_fearB <- rowMeans(data_wave5[, c("Beliefs_fearn", "Beliefs_notificationfearn")], na.rm = TRUE)

psy::cronbach(data_wave5[, c("Beliefs_fearn", "Beliefs_notificationfearn")])
hist(data_wave5$Beliefs_fearB)


##### Wave 6
data_wave6_in <- read.spss('L_Corona_app_wave6_3p.sav', to.data.frame=TRUE, use.missings=FALSE)
# Filter out the respondents that did not complete the entire survey 
data_wave6 <- data_wave6_in[!is.na(data_wave6_in$duur),]
data_wave6['wave'] <- 6

## Calculate mean scores on the different factors
# UTAUT: Performance expectancy
data_wave6$PE1_UTAUTn <- as.numeric(data_wave6$PE1_UTAUT)
data_wave6$PE2_UTAUTn <- as.numeric(data_wave6$PE2_UTAUT)
data_wave6$PE_UTAUT <- rowMeans(data_wave6[, c("PE1_UTAUTn", "PE2_UTAUTn")], na.rm = TRUE)

psy::cronbach(data_wave6[, c("PE1_UTAUTn", "PE2_UTAUTn")])
hist(data_wave6$PE_UTAUT)


# UTAUT: Effort expectancy (users)
data_wave6$EE1a_UTAUTn <- as.numeric(data_wave6$EE1a_UTAUT)
data_wave6$EE2a_UTAUTn <- as.numeric(data_wave6$EE2a_UTAUT)
# Since the item EE2a_UTAUT is positively phrased, it will be reverse coded such that higher numbers refer to higher EE
data_wave6$EE2a_UTAUTn_r = car::recode(data_wave6$EE2a_UTAUTn, '1=7; 2=6; 3=5; 4=4; 5=3; 6=2; 7=1')
data_wave6$EEa_UTAUT <- rowMeans(data_wave6[, c("EE1a_UTAUTn", "EE2a_UTAUTn_r")], na.rm = TRUE)

psy::cronbach(data_wave6[, c("EE1a_UTAUTn", "EE2a_UTAUTn_r")])
hist(data_wave6$EEa_UTAUT)


# UTAUT: Effort expectancy (non-users)
data_wave6$EE1b_UTAUTn <- as.numeric(data_wave6$EE1b_UTAUT)
data_wave6$EE2b_UTAUTn <- as.numeric(data_wave6$EE2b_UTAUT)
# Since the item EE2b_UTAUT is positively phrased, it will be reverse coded such that higher numbers refer to higher EE
data_wave6$EE2b_UTAUTn_r = car::recode(data_wave6$EE2b_UTAUTn, '1=7; 2=6; 3=5; 4=4; 5=3; 6=2; 7=1')
data_wave6$EEb_UTAUT <- rowMeans(data_wave6[, c("EE1b_UTAUTn", "EE2b_UTAUTn_r")], na.rm = TRUE)

psy::cronbach(data_wave6[, c("EE1b_UTAUTn", "EE2b_UTAUTn_r")])
hist(data_wave6$EEb_UTAUT)


# UTAUT: Effort expectancy (total)
data_wave6$EE1_UTAUT <- rowMeans(data_wave6[, c("EE1a_UTAUTn","EE1b_UTAUTn")], na.rm = TRUE)
data_wave6$EE2_UTAUT <- rowMeans(data_wave6[, c("EE2a_UTAUTn_r","EE2b_UTAUTn_r")], na.rm = TRUE)
data_wave6$EE_UTAUT <- rowMeans(data_wave6[, c("EE1_UTAUT", "EE2_UTAUT")], na.rm = TRUE)
psy::cronbach(data_wave6[, c("EE1_UTAUT","EE2_UTAUT")])
hist(data_wave6$EE_UTAUT)


# UTAUT: Social influence
data_wave6$SI1_UTAUTn <- as.numeric(data_wave6$SI1_UTAUT)
data_wave6$SI2_UTAUTn <- as.numeric(data_wave6$SI2_UTAUT)
data_wave6$SI_UTAUT <- rowMeans(data_wave6[, c("SI1_UTAUTn", "SI2_UTAUTn")], na.rm = TRUE)

psy::cronbach(data_wave6[, c("SI1_UTAUTn", "SI2_UTAUTn")])
hist(data_wave6$SI_UTAUT)


# UTAUT: Facilitating conditions
data_wave6$FC1_UTAUTn <- as.numeric(data_wave6$FC1_UTAUT)
data_wave6$FC2_UTAUTn <- as.numeric(data_wave6$FC2_UTAUT)
data_wave6$FC_UTAUT <- rowMeans(data_wave6[, c("FC1_UTAUTn", "FC2_UTAUTn")], na.rm = TRUE)

psy::cronbach(data_wave6[, c("FC1_UTAUTn", "FC2_UTAUTn")])
hist(data_wave6$FC_UTAUT)


# HBM: Perceived susceptibility
data_wave6$HBM_PSus_self1n <- as.numeric(data_wave6$HBM_PSus_self1)
data_wave6$HBM_PSus_self2n <- as.numeric(data_wave6$HBM_PSus_self2)
data_wave6$HBM_PSus_self <- rowMeans(data_wave6[, c("HBM_PSus_self1n", "HBM_PSus_self2n")], na.rm = TRUE)

psy::cronbach(data_wave6[, c("HBM_PSus_self1n", "HBM_PSus_self2n")])
hist(data_wave6$HBM_PSus_self)


# HBM: Perceived severity
data_wave6$HBM_PSev_self1n <- as.numeric(data_wave6$HBM_PSev_self1)
data_wave6$HBM_PSev_self2n <- as.numeric(data_wave6$HBM_PSev_self2)
data_wave6$HBM_PSev_self <- rowMeans(data_wave6[, c("HBM_PSev_self1n", "HBM_PSev_self2n")], na.rm = TRUE)

psy::cronbach(data_wave6[, c("HBM_PSev_self1n", "HBM_PSev_self2n")])
hist(data_wave6$HBM_PSev_self)


# The variables measured from not true - true (5 point scales with 'I don't know as answer options) are recoded, so that 'I don't know' represents the middle value. This should also be recoded, as more data safety is fewer concerns.
data_wave6$Beliefs_datasafetyn <- as.numeric(data_wave6$Beliefs_datasafety)
data_wave6$Beliefs_datasafety_5p <- car::recode(data_wave6$Beliefs_datasafetyn, '1=5; 2=4; 3=2; 4=1; 5=3') 

bla <- data.frame(levels = unique(data_wave6$Beliefs_datasafety), value = as.numeric(unique(data_wave6$Beliefs_datasafety)))

# From Nadine
data_wave6$Beliefs_technologyperformancen <- as.numeric(data_wave6$Beliefs_technologyperformance)
data_wave6$Beliefs_falsesecurity1n <- as.numeric(data_wave6$Beliefs_falsesecurity1)
data_wave6$Beliefs_falsesecurity2n <- as.numeric(data_wave6$Beliefs_falsesecurity2)
data_wave6$Beliefs_technologyperformance_5p <- car::recode(data_wave6$Beliefs_technologyperformancen, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave6$Beliefs_falsesecurity1_5p <- car::recode(data_wave6$Beliefs_falsesecurity1n, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave6$Beliefs_falsesecurity2_5p <- car::recode(data_wave6$Beliefs_falsesecurity2n, '1=1; 2=2; 3=4; 4=5; 5=3') 

data_wave6 <- data_wave6 %>% mutate(Infectother = case_when( 
  data_wave6$CoronaInfectionOther_1 == 'Ja' | data_wave6$CoronaInfectionOther_2 == 'Ja' | data_wave6$CoronaInfectionOther_3 == 'Ja' | data_wave6$CoronaInfectionOther_4 == 'Ja' | data_wave6$CoronaInfectionOther_5 == 'Ja' | data_wave6$CoronaInfectionOther_6 == 'Ja' ~ 1,
  data_wave6$CoronaInfectionOther_7 == 'Ja' | data_wave6$CoronaInfectionOther_8 == 'Ja' ~ 0))

infectotherprop <- table(data_wave6$Infectother) / length (data_wave6$Infectother)



# Contextual: False security beliefs
#data_wave6$Beliefs_falsesecurity1n <- as.numeric(data_wave6$Beliefs_falsesecurity1)
#data_wave6$Beliefs_falsesecurity2n <- as.numeric(data_wave6$Beliefs_falsesecurity2)
#data_wave6$Beliefs_falsesecurity <- rowMeans(data_wave6[, c("Beliefs_falsesecurity1n", "Beliefs_falsesecurity2n")], na.rm = TRUE)

#psy::cronbach(data_wave6[, c("Beliefs_falsesecurity1n", "Beliefs_falsesecurity2n")])
#hist(data_wave6$Beliefs_falsesecurity)

# Contextual: Societal beliefs
data_wave6$Beliefs_civicdutyn <- as.numeric(data_wave6$Beliefs_civicduty)
data_wave6$Beliefs_benefiteconomicn <- as.numeric(data_wave6$Beliefs_benefiteconomic)
data_wave6$Beliefs_Protectriskgroupsn <- as.numeric(data_wave6$Beliefs_Protectriskgroups)
data_wave6$Beliefs_TrustGovernmentn <- as.numeric(data_wave6$Beliefs_TrustGovernment)
data_wave6$Beliefs_Society <- rowMeans(data_wave6[, c("Beliefs_civicdutyn", "Beliefs_benefiteconomicn", "Beliefs_Protectriskgroupsn", "Beliefs_TrustGovernmentn")], na.rm = TRUE)

psy::cronbach(data_wave6[, c("Beliefs_civicdutyn", "Beliefs_benefiteconomicn", "Beliefs_Protectriskgroupsn", "Beliefs_TrustGovernmentn")])
hist(data_wave6$Beliefs_Society)


# Contextual: Conspiracy beliefs
data_wave6$Beliefs_Conspiracy1n <- as.numeric(data_wave6$Beliefs_Conspiracy1)
data_wave6$Beliefs_Conspiracy2n <- as.numeric(data_wave6$Beliefs_Conspiracy2)

# The variables measured from not true - true (5 point scales with 'I don't know as answer options) are recoded, so that 'I don't know' represents the middle value.
data_wave6$Beliefs_Conspiracy1_5p <- car::recode(data_wave6$Beliefs_Conspiracy1n, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave6$Beliefs_Conspiracy2_5p <- car::recode(data_wave6$Beliefs_Conspiracy2n, '1=1; 2=2; 3=4; 4=5; 5=3') 


data_wave6$Beliefs_Conspiracy <- rowMeans(data_wave6[, c("Beliefs_Conspiracy1_5p", "Beliefs_Conspiracy2_5p")], na.rm = TRUE)

psy::cronbach(data_wave6[, c("Beliefs_Conspiracy1_5p", "Beliefs_Conspiracy2_5p")])
hist(data_wave6$Beliefs_Conspiracy)


# Contextual: Monitoring beliefs
data_wave6$Beliefs_locationmonitoringn <- as.numeric(data_wave6$Beliefs_locationmonitoring)
data_wave6$Beliefs_identitymonitoringn <- as.numeric(data_wave6$Beliefs_identitymonitoring)

# The variables measured from not true - true (5 point scales with 'I don't know as answer options) are recoded, so that 'I don't know' represents the middle value.
data_wave6$Beliefs_locationmonitoring_5p <- car::recode(data_wave6$Beliefs_locationmonitoringn, '1=1; 2=2; 3=4; 4=5; 5=3') 
data_wave6$Beliefs_identitymonitoring_5p <- car::recode(data_wave6$Beliefs_identitymonitoringn, '1=1; 2=2; 3=4; 4=5; 5=3')

data_wave6$Beliefs_monitoring <- rowMeans(data_wave6[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p")], na.rm = TRUE)

psy::cronbach(data_wave6[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p")])
#psy::cronbach(data_wave6[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p", "Beliefs_datasafety_5p")])
hist(data_wave6$Beliefs_monitoring)


# Contextual: Fear beliefs
data_wave6$Beliefs_fearn <- as.numeric(data_wave6$Beliefs_fear)
data_wave6$Beliefs_notificationfearn <- as.numeric(data_wave6$Beliefs_notificationfear)
data_wave6$Beliefs_fearB <- rowMeans(data_wave6[, c("Beliefs_fearn", "Beliefs_notificationfearn")], na.rm = TRUE)

psy::cronbach(data_wave6[, c("Beliefs_fearn", "Beliefs_notificationfearn")])
hist(data_wave6$Beliefs_fearB)


# Remove columns that are not present in all waves
data_wave1 <- data_wave1[, intersect(colnames(data_wave1), colnames(data_wave2))]
data_wave1 <- data_wave1[, intersect(colnames(data_wave1), colnames(data_wave3))]
data_wave1 <- data_wave1[, intersect(colnames(data_wave1), colnames(data_wave4))]
data_wave1 <- data_wave1[, intersect(colnames(data_wave1), colnames(data_wave5))]
data_wave1 <- data_wave1[, intersect(colnames(data_wave1), colnames(data_wave6))]

data_wave2 <- data_wave2[, intersect(colnames(data_wave2), colnames(data_wave1))]
data_wave3 <- data_wave3[, intersect(colnames(data_wave3), colnames(data_wave1))]
data_wave4 <- data_wave4[, intersect(colnames(data_wave4), colnames(data_wave1))]
data_wave5 <- data_wave5[, intersect(colnames(data_wave5), colnames(data_wave1))]
data_wave6 <- data_wave6[, intersect(colnames(data_wave6), colnames(data_wave1))]

# Remove respondents from wave 5 and 6 that did not participate in waves 2-4
data_wave5 = data_wave5[(data_wave5$nomem_encr %in% data_wave4$nomem_encr),]
data_wave6 = data_wave6[(data_wave6$nomem_encr %in% data_wave5$nomem_encr),]


# Some tests to identify respondents who said they never used the CoronaMelder even though in other waves they did report using it
test2 <- filter(data_wave2, Behavior_UTAUT == "Ik heb de CoronaMelder app nooit gebruikt" & (nomem_encr %in% data_wave1[data_wave1$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr))

test3 <- filter(data_wave3, Behavior_UTAUT == "Ik heb de CoronaMelder app nooit gebruikt" & (nomem_encr %in% data_wave2[data_wave2$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr))

test4 <- filter(data_wave4, Behavior_UTAUT == "Ik heb de CoronaMelder app nooit gebruikt" & (nomem_encr %in% data_wave3[data_wave3$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr))

test5 <- filter(data_wave5, Behavior_UTAUT == "Ik heb de CoronaMelder app nooit gebruikt" & (nomem_encr %in% data_wave4[data_wave4$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr))

test6 <- filter(data_wave6, Behavior_UTAUT == "Ik heb de CoronaMelder app nooit gebruikt" & (nomem_encr %in% data_wave5[data_wave5$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr))


# Make a long table with all rows with respondents, their start time (start using), and event time (stop using), if applicable, otherwise right censored

# In wave 1, people who have used but already stopped have stopped within the first few weeks that the app was available. We therefore set start time to 0 and event to 1 (month)
# Use months instead of waves because they are not equally spaced
# use %in% to find those that were not using last wave
data_wave1['event'] <- 0
data_wave1['month'] <- 1

data_wave1[data_wave1$Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer",]['event'] <- 1
data_wave1[data_wave1$Behavior_UTAUT == "Ik heb de CoronaMelder app nooit gebruikt",]['event'] <- 1

data_complete <- data_wave1[data_wave1$Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer",]
data_complete <- rbind(data_complete, data_wave1[data_wave1$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",])


# === WAVE 2 ===
data_wave2['event'] <- 0
data_wave2['month'] <- 1

count_newusers2 = 0

data_wave2[data_wave2$Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer",]['event'] <- 1
data_wave2[data_wave2$Behavior_UTAUT == "Ik heb de CoronaMelder app nooit gebruikt",]['event'] <- 1

# People that stopped
data_new_wave2 <- filter(data_wave2, Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer" & !(nomem_encr %in% data_wave1[data_wave1$Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer",]$nomem_encr))

# More people that stopped (but indicated that they never used it)
data_new_wave2 <- rbind(data_new_wave2, filter(data_wave2, Behavior_UTAUT == "Ik heb de CoronaMelder app nooit gebruikt" & (nomem_encr %in% data_wave1[data_wave1$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

# Ongoing users
data_new_wave2 <- rbind(data_new_wave2, filter(data_wave2, Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment" & (nomem_encr %in% data_wave1[data_wave1$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

for (row in 1:nrow(data_new_wave2)) {
  # Like with wave 1, also in later waves it is possible that someone started using and stopped again, even within one wave
  # This checks for that situation, and puts month to 1 if it is the case
  if (is.na(min(data_complete[data_complete$nomem_encr == data_new_wave2[row, "nomem_encr"],]$DatumE))) {
    data_new_wave2[row, "month"] <- 1
    count_newusers2 = count_newusers2 + 1
  } else {
    first_wave <- min(data_complete[data_complete$nomem_encr == data_new_wave2[row, "nomem_encr"],]$wave)
    date_current <- as.Date(data_new_wave2[row, "DatumE"], "%d-%m-%Y")
    date_start <- as.Date(filter(data_complete, wave == first_wave & nomem_encr == data_new_wave2[row, "nomem_encr"])$DatumE, "%d-%m-%Y")
    
    days <- interval(date_start, date_current) %/% days(1)
    data_new_wave2[row, "month"] <- round(days / 30) + 1
    
  }
}

# Newly started
data_new_wave2 <- rbind(data_new_wave2, filter(data_wave2, Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment" & !(nomem_encr %in% data_wave1[data_wave1$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

count_newusers2 = count_newusers2 + nrow(filter(data_wave2, Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment" & !(nomem_encr %in% data_wave1[data_wave1$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

#b <- filter(data_new_wave2, nomem_encr %in% data_complete[data_complete$event == 1,]$nomem_encr)

data_complete <- rbind(data_complete, filter(data_new_wave2, !(nomem_encr %in% data_complete[data_complete$event == 1,]$nomem_encr)))


# === WAVE 3 ===
data_wave3['event'] <- 0
data_wave3['month'] <- 1

count_newusers3 = 0

data_wave3[data_wave3$Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer",]['event'] <- 1
data_wave3[data_wave3$Behavior_UTAUT == "Ik heb de CoronaMelder app nooit gebruikt",]['event'] <- 1

# People that stopped
data_new_wave3 <- filter(data_wave3, Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer" & !(nomem_encr %in% data_wave2[data_wave2$Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer",]$nomem_encr))

# More people that stopped (but indicated that they never used it)
data_new_wave3 <- rbind(data_new_wave3, filter(data_wave3, Behavior_UTAUT == "Ik heb de CoronaMelder app nooit gebruikt" & (nomem_encr %in% data_wave2[data_wave2$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

# Ongoing users
data_new_wave3 <- rbind(data_new_wave3, filter(data_wave3, Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment" & (nomem_encr %in% data_wave2[data_wave2$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

for (row in 1:nrow(data_new_wave3)) {
  # Like with wave 1, also in later waves it is possible that someone started using and stopped again, even within one wave
  # This checks for that situation, and puts month to 1 if it is the case
  if (is.na(min(data_complete[data_complete$nomem_encr == data_new_wave3[row, "nomem_encr"],]$DatumE))) {
    data_new_wave3[row, "month"] <- 1
    count_newusers3 = count_newusers3 + 1
  } else {
    
    first_wave <- min(data_complete[data_complete$nomem_encr == data_new_wave3[row, "nomem_encr"],]$wave)
    date_current <- as.Date(data_new_wave3[row, "DatumE"], "%d-%m-%Y")
    date_start <- as.Date(filter(data_complete, wave == first_wave & nomem_encr == data_new_wave3[row, "nomem_encr"])$DatumE, "%d-%m-%Y")
    
    days <- interval(date_start, date_current) %/% days(1)
    data_new_wave3[row, "month"] <- round(days / 30) + 1
  }
}

# Newly started
data_new_wave3 <- rbind(data_new_wave3, filter(data_wave3, Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment" & !(nomem_encr %in% data_wave2[data_wave2$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

count_newusers3 = count_newusers3 + nrow(filter(data_wave3, Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment" & !(nomem_encr %in% data_wave2[data_wave2$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

#b <- filter(data_new_wave3, nomem_encr %in% data_complete[data_complete$event == 1,]$nomem_encr)

data_complete <- rbind(data_complete, filter(data_new_wave3, !(nomem_encr %in% data_complete[data_complete$event == 1,]$nomem_encr)))



# === WAVE 4 ===
data_wave4['event'] <- 0
data_wave4['month'] <- 1

count_newusers4 = 0

data_wave4[data_wave4$Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer",]['event'] <- 1
data_wave4[data_wave4$Behavior_UTAUT == "Ik heb de CoronaMelder app nooit gebruikt",]['event'] <- 1

# People that stopped
data_new_wave4 <- filter(data_wave4, Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer" & !(nomem_encr %in% data_wave3[data_wave3$Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer",]$nomem_encr))

# More people that stopped (but indicated that they never used it)
data_new_wave4 <- rbind(data_new_wave4, filter(data_wave4, Behavior_UTAUT == "Ik heb de CoronaMelder app nooit gebruikt" & (nomem_encr %in% data_wave3[data_wave3$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

# Ongoing users
data_new_wave4 <- rbind(data_new_wave4, filter(data_wave4, Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment" & (nomem_encr %in% data_wave3[data_wave3$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

for (row in 1:nrow(data_new_wave4)) {
  # Like with wave 1, also in later waves it is possible that someone started using and stopped again, even within one wave
  # This checks for that situation, and puts month to 1 if it is the case
  if (is.na(min(data_complete[data_complete$nomem_encr == data_new_wave4[row, "nomem_encr"],]$DatumE))) {
    data_new_wave4[row, "month"] <- 1
    count_newusers4 = count_newusers4 + 1
  } else {
    
    first_wave <- min(data_complete[data_complete$nomem_encr == data_new_wave4[row, "nomem_encr"],]$wave)
    date_current <- as.Date(data_new_wave4[row, "DatumE"], "%d-%m-%Y")
    date_start <- as.Date(filter(data_complete, wave == first_wave & nomem_encr == data_new_wave4[row, "nomem_encr"])$DatumE, "%d-%m-%Y")
    
    days <- interval(date_start, date_current) %/% days(1)
    data_new_wave4[row, "month"] <- round(days / 30) + 1
  }
}

# Newly started
data_new_wave4 <- rbind(data_new_wave4, filter(data_wave4, Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment" & !(nomem_encr %in% data_wave3[data_wave3$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

count_newusers4 = count_newusers4 + nrow(filter(data_wave4, Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment" & !(nomem_encr %in% data_wave3[data_wave3$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

#b <- filter(data_new_wave4, nomem_encr %in% data_complete[data_complete$event == 1,]$nomem_encr)

data_complete <- rbind(data_complete, filter(data_new_wave4, !(nomem_encr %in% data_complete[data_complete$event == 1,]$nomem_encr)))




# === WAVE 5 ===
data_wave5['event'] <- 0
data_wave5['month'] <- 1

count_newusers5 = 0

data_wave5[data_wave5$Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer",]['event'] <- 1
data_wave5[data_wave5$Behavior_UTAUT == "Ik heb de CoronaMelder app nooit gebruikt",]['event'] <- 1

# People that stopped
data_new_wave5 <- filter(data_wave5, Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer" & !(nomem_encr %in% data_wave4[data_wave4$Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer",]$nomem_encr))

# More people that stopped (but indicated that they never used it)
data_new_wave5 <- rbind(data_new_wave5, filter(data_wave5, Behavior_UTAUT == "Ik heb de CoronaMelder app nooit gebruikt" & (nomem_encr %in% data_wave4[data_wave4$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

# Ongoing users
data_new_wave5 <- rbind(data_new_wave5, filter(data_wave5, Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment" & (nomem_encr %in% data_wave4[data_wave4$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

for (row in 1:nrow(data_new_wave5)) {
  # Like with wave 1, also in later waves it is possible that someone started using and stopped again, even within one wave
  # This checks for that situation, and puts month to 1 if it is the case
  if (is.na(min(data_complete[data_complete$nomem_encr == data_new_wave5[row, "nomem_encr"],]$DatumE))) {
    data_new_wave5[row, "month"] <- 1
    count_newusers5 = count_newusers5 + 1
  } else {
    
    first_wave <- min(data_complete[data_complete$nomem_encr == data_new_wave5[row, "nomem_encr"],]$wave)
    
    # For some reason the date format in waves 5 and 6 are different
    date_current <- as.Date(data_new_wave5[row, "DatumE"], "%Y-%m-%d")
    
    # Now we need to check the date format, because the starting wave could be 1-4 (old format) or 5-6 (new format)
    if(unlist(gregexpr('-', filter(data_complete, wave == first_wave & nomem_encr == data_new_wave5[row, "nomem_encr"])$DatumE))[1] == 3) {
      date_start <- as.Date(filter(data_complete, wave == first_wave & nomem_encr == data_new_wave5[row, "nomem_encr"])$DatumE, "%d-%m-%Y")
      
    } else {
      date_start <- as.Date(filter(data_complete, wave == first_wave & nomem_encr == data_new_wave5[row, "nomem_encr"])$DatumE, "%Y-%m-%d")
    }
    
    days <- interval(date_start, date_current) %/% days(1)
    data_new_wave5[row, "month"] <- round(days / 30) + 1
  }
}

# Newly started
data_new_wave5 <- rbind(data_new_wave5, filter(data_wave5, Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment" & !(nomem_encr %in% data_wave4[data_wave4$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

count_newusers5 = count_newusers5 + nrow(filter(data_wave5, Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment" & !(nomem_encr %in% data_wave4[data_wave4$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

#b <- filter(data_new_wave5, nomem_encr %in% data_complete[data_complete$event == 1,]$nomem_encr)

data_complete <- rbind(data_complete, filter(data_new_wave5, !(nomem_encr %in% data_complete[data_complete$event == 1,]$nomem_encr)))


# === WAVE 6 ===
data_wave6['event'] <- 0
data_wave6['month'] <- 1

count_newusers6 = 0

data_wave6[data_wave6$Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer",]['event'] <- 1
data_wave6[data_wave6$Behavior_UTAUT == "Ik heb de CoronaMelder app nooit gebruikt",]['event'] <- 1

# People that stopped
data_new_wave6 <- filter(data_wave6, Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer" & !(nomem_encr %in% data_wave5[data_wave5$Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer",]$nomem_encr))

# More people that stopped (but indicated that they never used it)
data_new_wave6 <- rbind(data_new_wave6, filter(data_wave6, Behavior_UTAUT == "Ik heb de CoronaMelder app nooit gebruikt" & (nomem_encr %in% data_wave5[data_wave5$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

# Ongoing users
data_new_wave6 <- rbind(data_new_wave6, filter(data_wave6, Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment" & (nomem_encr %in% data_wave5[data_wave5$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

for (row in 1:nrow(data_new_wave6)) {
  # Like with wave 1, also in later waves it is possible that someone started using and stopped again, even within one wave
  # This checks for that situation, and puts month to 1 if it is the case
  if (is.na(min(data_complete[data_complete$nomem_encr == data_new_wave6[row, "nomem_encr"],]$DatumE))) {
    data_new_wave6[row, "month"] <- 1
    count_newusers6 = count_newusers6 + 1
  } else {
    
    first_wave <- min(data_complete[data_complete$nomem_encr == data_new_wave6[row, "nomem_encr"],]$wave)
    
    
    # For some reason the date format in waves 5 and 6 are different
    date_current <- as.Date(data_new_wave6[row, "DatumE"], "%Y-%m-%d")
    
    # Now we need to check the date format, because the starting wave could be 1-4 (old format) or 5-6 (new format)
    if(unlist(gregexpr('-', filter(data_complete, wave == first_wave & nomem_encr == data_new_wave6[row, "nomem_encr"])$DatumE))[1] == 3) {
      date_start <- as.Date(filter(data_complete, wave == first_wave & nomem_encr == data_new_wave6[row, "nomem_encr"])$DatumE, "%d-%m-%Y")
      
    } else {
      date_start <- as.Date(filter(data_complete, wave == first_wave & nomem_encr == data_new_wave6[row, "nomem_encr"])$DatumE, "%Y-%m-%d")
    }
    
    days <- interval(date_start, date_current) %/% days(1)
    data_new_wave6[row, "month"] <- round(days / 30) + 1
  }
}

# Newly started
data_new_wave6 <- rbind(data_new_wave6, filter(data_wave6, Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment" & !(nomem_encr %in% data_wave5[data_wave5$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

count_newusers6 = count_newusers6 + nrow(filter(data_wave6, Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment" & !(nomem_encr %in% data_wave5[data_wave5$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]$nomem_encr)))

#b <- filter(data_new_wave6, nomem_encr %in% data_complete[data_complete$event == 1,]$nomem_encr)

data_complete <- rbind(data_complete, filter(data_new_wave6, !(nomem_encr %in% data_complete[data_complete$event == 1,]$nomem_encr)))

#test <- data_wave6[data_wave6$Behavior_UTAUT == "Ik gebruik de CoronaMelder app op dit moment",]


# Cronbach's
participants <- unique(data_complete$nomem_encr)
data_w1c <- filter(data_wave1, nomem_encr %in% participants)
data_w2c <- filter(data_wave2, nomem_encr %in% participants)
data_w3c <- filter(data_wave3, nomem_encr %in% participants)
data_w4c <- filter(data_wave4, nomem_encr %in% participants)
data_w5c <- filter(data_wave5, nomem_encr %in% participants)
data_w6c <- filter(data_wave6, nomem_encr %in% participants)

# UTAUT: Performance expectancy
psy::cronbach(data_w1c[, c("PE1_UTAUTn", "PE2_UTAUTn")])
psy::cronbach(data_w2c[, c("PE1_UTAUTn", "PE2_UTAUTn")])
psy::cronbach(data_w3c[, c("PE1_UTAUTn", "PE2_UTAUTn")])
psy::cronbach(data_w4c[, c("PE1_UTAUTn", "PE2_UTAUTn")])
psy::cronbach(data_w5c[, c("PE1_UTAUTn", "PE2_UTAUTn")])
psy::cronbach(data_w6c[, c("PE1_UTAUTn", "PE2_UTAUTn")])

# UTAUT: Effort expectancy (total)
psy::cronbach(data_w1c[, c("EE1_UTAUT","EE2_UTAUT")])
psy::cronbach(data_w2c[, c("EE1_UTAUT","EE2_UTAUT")])
psy::cronbach(data_w3c[, c("EE1_UTAUT","EE2_UTAUT")])
psy::cronbach(data_w4c[, c("EE1_UTAUT","EE2_UTAUT")])
psy::cronbach(data_w5c[, c("EE1_UTAUT","EE2_UTAUT")])
psy::cronbach(data_w6c[, c("EE1_UTAUT","EE2_UTAUT")])

# UTAUT: Social influence
psy::cronbach(data_w1c[, c("SI1_UTAUTn", "SI2_UTAUTn")])
psy::cronbach(data_w2c[, c("SI1_UTAUTn", "SI2_UTAUTn")])
psy::cronbach(data_w3c[, c("SI1_UTAUTn", "SI2_UTAUTn")])
psy::cronbach(data_w4c[, c("SI1_UTAUTn", "SI2_UTAUTn")])
psy::cronbach(data_w5c[, c("SI1_UTAUTn", "SI2_UTAUTn")])
psy::cronbach(data_w6c[, c("SI1_UTAUTn", "SI2_UTAUTn")])

# UTAUT: Facilitating conditions
psy::cronbach(data_w1c[, c("FC1_UTAUTn", "FC2_UTAUTn")])
psy::cronbach(data_w2c[, c("FC1_UTAUTn", "FC2_UTAUTn")])
psy::cronbach(data_w3c[, c("FC1_UTAUTn", "FC2_UTAUTn")])
psy::cronbach(data_w4c[, c("FC1_UTAUTn", "FC2_UTAUTn")])
psy::cronbach(data_w5c[, c("FC1_UTAUTn", "FC2_UTAUTn")])
psy::cronbach(data_w6c[, c("FC1_UTAUTn", "FC2_UTAUTn")])

# HBM: Perceived susceptibility
psy::cronbach(data_w1c[, c("HBM_PSus_self1n", "HBM_PSus_self2n")])
psy::cronbach(data_w2c[, c("HBM_PSus_self1n", "HBM_PSus_self2n")])
psy::cronbach(data_w3c[, c("HBM_PSus_self1n", "HBM_PSus_self2n")])
psy::cronbach(data_w4c[, c("HBM_PSus_self1n", "HBM_PSus_self2n")])
psy::cronbach(data_w5c[, c("HBM_PSus_self1n", "HBM_PSus_self2n")])
psy::cronbach(data_w6c[, c("HBM_PSus_self1n", "HBM_PSus_self2n")])

# HBM: Perceived severity
psy::cronbach(data_w1c[, c("HBM_PSev_self1n", "HBM_PSev_self2n")])
psy::cronbach(data_w2c[, c("HBM_PSev_self1n", "HBM_PSev_self2n")])
psy::cronbach(data_w3c[, c("HBM_PSev_self1n", "HBM_PSev_self2n")])
psy::cronbach(data_w4c[, c("HBM_PSev_self1n", "HBM_PSev_self2n")])
psy::cronbach(data_w5c[, c("HBM_PSev_self1n", "HBM_PSev_self2n")])
psy::cronbach(data_w6c[, c("HBM_PSev_self1n", "HBM_PSev_self2n")])

# Contextual: Societal beliefs
psy::cronbach(data_w1c[, c("Beliefs_civicdutyn", "Beliefs_benefiteconomicn", "Beliefs_Protectriskgroupsn", "Beliefs_TrustGovernmentn")])
psy::cronbach(data_w2c[, c("Beliefs_civicdutyn", "Beliefs_benefiteconomicn", "Beliefs_Protectriskgroupsn", "Beliefs_TrustGovernmentn")])
psy::cronbach(data_w3c[, c("Beliefs_civicdutyn", "Beliefs_benefiteconomicn", "Beliefs_Protectriskgroupsn", "Beliefs_TrustGovernmentn")])
psy::cronbach(data_w4c[, c("Beliefs_civicdutyn", "Beliefs_benefiteconomicn", "Beliefs_Protectriskgroupsn", "Beliefs_TrustGovernmentn")])
psy::cronbach(data_w5c[, c("Beliefs_civicdutyn", "Beliefs_benefiteconomicn", "Beliefs_Protectriskgroupsn", "Beliefs_TrustGovernmentn")])
psy::cronbach(data_w6c[, c("Beliefs_civicdutyn", "Beliefs_benefiteconomicn", "Beliefs_Protectriskgroupsn", "Beliefs_TrustGovernmentn")])

# Contextual: Conspiracy beliefs
psy::cronbach(data_w1c[, c("Beliefs_Conspiracy1_5p", "Beliefs_Conspiracy2_5p")])
psy::cronbach(data_w2c[, c("Beliefs_Conspiracy1_5p", "Beliefs_Conspiracy2_5p")])
psy::cronbach(data_w3c[, c("Beliefs_Conspiracy1_5p", "Beliefs_Conspiracy2_5p")])
psy::cronbach(data_w4c[, c("Beliefs_Conspiracy1_5p", "Beliefs_Conspiracy2_5p")])
psy::cronbach(data_w5c[, c("Beliefs_Conspiracy1_5p", "Beliefs_Conspiracy2_5p")])
psy::cronbach(data_w6c[, c("Beliefs_Conspiracy1_5p", "Beliefs_Conspiracy2_5p")])

# Contextual: Monitoring beliefs
psy::cronbach(data_w1c[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p")])
psy::cronbach(data_w2c[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p")])
psy::cronbach(data_w3c[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p")])
psy::cronbach(data_w4c[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p")])
psy::cronbach(data_w5c[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p")])
psy::cronbach(data_w6c[, c("Beliefs_locationmonitoring_5p", "Beliefs_identitymonitoring_5p")])

# Contextual: Fear beliefs
psy::cronbach(data_w1c[, c("Beliefs_fearn", "Beliefs_notificationfearn")])
psy::cronbach(data_w2c[, c("Beliefs_fearn", "Beliefs_notificationfearn")])
psy::cronbach(data_w3c[, c("Beliefs_fearn", "Beliefs_notificationfearn")])
psy::cronbach(data_w4c[, c("Beliefs_fearn", "Beliefs_notificationfearn")])
psy::cronbach(data_w5c[, c("Beliefs_fearn", "Beliefs_notificationfearn")])
psy::cronbach(data_w6c[, c("Beliefs_fearn", "Beliefs_notificationfearn")])


# Some useful tests for analyses
tmp <- data_complete[, c("nomem_encr", "month", "wave", "event", "DatumE")]
num_respondents <- unique(data_complete$nomem_encr)

num_rightcensored <- data_complete[, c('nomem_encr', 'event')]
num_rightcensored <- num_rightcensored %>% group_by(nomem_encr) %>% filter(event == max(event))
num_rightcensored <- unique(num_rightcensored, by = "nomem_encr")
num_rightcensored <- num_rightcensored[num_rightcensored$event == 0,] # right censored respondents

for (row in 1:nrow(num_rightcensored)) {
  num_rightcensored[row, "last_wave"] <- max(data_complete[data_complete$nomem_encr == num_rightcensored[row, "nomem_encr"]$nomem_encr,]$wave)
}

num_rightcensored_endstudy <- num_rightcensored[num_rightcensored$last_wave != 6,]



# Survival analysis
# 1. Inspecting the relationship between time points and the cloglog transformation of the observed hazards
#    to determine the baseline hazard.

data_complete %>%
  group_by(month) %>%
  summarise(event = sum(event),
            total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth()


data_base <- data_complete %>%
  group_by(month) %>%
  summarise(event = sum(event),
            total = n())

data_base <- data_base[-c(5,7,8,9,10,11,13,14,15,17),]

data_base %>% mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth()

ggplot(data_complete, aes(x = month, y = event)) + geom_smooth() + stat_smooth(method="lm", se=TRUE, fill=NA,
                formula=y ~ poly(x, 4, raw=TRUE),colour="red")

data_complete %>%
  group_by(month) %>%
  summarise(event = sum(event),
            total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = log(hazard/(1-hazard)))) + # log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth()



Gompertz_Model_Baseline <- glm(formula = event ~ month,
                               family = binomial(link = "logit"),
                               data = data_complete)

Gompertz_Model_nl_Baseline <- glm(formula = event ~ poly(month, 4, raw=TRUE) + wave,
                               family = binomial(link = "logit"),
                               data = data_complete)

summary(Gompertz_Model_Baseline)
summary(Gompertz_Model_nl_Baseline)

summ(Gompertz_Model_Baseline, exp = T) #exp = T means that we want exponentiated estimates
summ(Gompertz_Model_nl_Baseline, exp = T) #exp = T means that we want exponentiated estimates

Gompertz_Model_Baseline$aic
Gompertz_Model_nl_Baseline$aic


# With a baseline model, check which link function performs best
ids <- data.frame(nomem_encr = unique(data_complete$nomem_encr))
set.seed(123)
ids_train <- sample_frac(ids, 0.8)
ids_test <- ids[!ids$nomem_encr %in% ids_train$nomem_encr,]
data_complete_train <- data_complete[data_complete$nomem_encr %in% ids_train$nomem_encr,]
data_complete_test <- data_complete[data_complete$nomem_encr %in% ids_test,]

Gompertz_Model_Baseline_tr <- glm(formula = event ~ month,
                               family = binomial(link = "cloglog"),
                               data = data_complete_train)

Gompertz_Model_Baseline <- glm(formula = event ~ month,
                               family = binomial(link = "logit"),
                               data = data_complete)

Gompertz_Model_Baseline2 <- glm(formula = event ~ poly(month, 4),
                               family = binomial(link = "logit"),
                               data = data_complete)

summary(Gompertz_Model_Baseline)
summary(Gompertz_Model_Baseline2)
summ(Gompertz_Model_Baseline, exp = T)
summ(Gompertz_Model_Baseline2, exp = T)


Gompertz_Model_Context_tr <- glm(formula = event ~ poly(month, 4) + PE_UTAUT + EE_UTAUT + FC_UTAUT + SI_UTAUT + HBM_PSus_self + HBM_PSev_self + HBM_selfefficacy_CoronaMelder + HBM_perceivedbenefits_CoronaMelder + HBM_barriers_CoronaMelder + Beliefs_monitoring + Beliefs_Conspiracy + Beliefs_fearB + Beliefs_Society + Beliefs_datasafety_5p + HBM_PSus_other2 + HBM_PSev_other2 + Beliefs_technologyperformance_5p + Infectother + geslacht + lftdcat_re + oplcat_re,
                               family = binomial(link = "cloglog"),
                               data = data_complete_train)

Gompertz_Model_Context_tr2 <- glm(formula = event ~ poly(month, 4) + PE_UTAUT + EE_UTAUT + FC_UTAUT + SI_UTAUT + HBM_PSus_self + HBM_PSev_self + HBM_selfefficacy_CoronaMelder + HBM_perceivedbenefits_CoronaMelder + HBM_barriers_CoronaMelder + Beliefs_monitoring + Beliefs_Conspiracy + Beliefs_fearB + Beliefs_Society + Beliefs_datasafety_5p + HBM_PSus_other2 + HBM_PSev_other2 + Beliefs_technologyperformance_5p + Infectother + geslacht + lftdcat_re + oplcat_re,
                               family = binomial(link = "logit"),
                               data = data_complete_train)




#observed hazards
Obs_Haz <- pull(data_complete_test, event)

#predicted hazards
Pred_Haz_Full <- predict(Gompertz_Model_Baseline_tr, data_complete_test, type = "response")

#predictive deviance
Pred_Dev_Full <- tibble(obs = Obs_Haz, pred = Pred_Haz_Full) %>%
  mutate(dev = obs*log(pred) + (1-obs)*log(1-pred)) %>%
  summarise(deviance = -2*sum(dev))%>%
  pull(deviance)

Pred_Dev_Full


#predicted hazards
Pred_Haz_Full2 <- predict(Gompertz_Model_Baseline_tr2, data_complete_test, type = "response")

#predictive deviance
Pred_Dev_Full2 <- tibble(obs = Obs_Haz, pred = Pred_Haz_Full2) %>%
  mutate(dev = obs*log(pred) + (1-obs)*log(1-pred)) %>%
  summarise(deviance = -2*sum(dev))%>%
  pull(deviance)

Pred_Dev_Full2



# Version with a polynomial base hazard appears to have a better fit (lower AIC), so we might want to continue with that


# 2. Include demographic predictors

# Recode age categories into 17-34, 35-54, 55-64, 65-89 (cf. our previous paper)
max(data_complete$leeftijd)
data_complete$lftdcat_re <- NA
data_complete[data_complete$lftdcat == '15 - 24 jaar', ]$lftdcat_re <- '17 - 34 jaar'
data_complete[data_complete$lftdcat == '25 - 34 jaar', ]$lftdcat_re <- '17 - 34 jaar'
data_complete[data_complete$lftdcat == '35 - 44 jaar', ]$lftdcat_re <- '35 - 54 jaar'
data_complete[data_complete$lftdcat == '45 - 54 jaar', ]$lftdcat_re <- '35 - 54 jaar'
data_complete[data_complete$lftdcat == '55 - 64 jaar', ]$lftdcat_re <- '55 - 64 jaar'
data_complete[data_complete$lftdcat == '65 jaar en ouder',]$lftdcat_re <- '65 - 89 jaar'


# Recode education level into low, medium, high (cf. our previous paper and Statistics Netherlands / CBS)
data_complete$oplcat_re <- NA
data_complete[data_complete$oplcat == 'basisonderwijs', ]$oplcat_re <- 'low'
data_complete[data_complete$oplcat == 'vmbo', ]$oplcat_re <- 'low'
data_complete[data_complete$oplcat == 'havo/vwo', ]$oplcat_re <- 'middle'
data_complete[data_complete$oplcat == 'mbo', ]$oplcat_re <- 'middle'
data_complete[data_complete$oplcat == 'hbo', ]$oplcat_re <- 'high'
data_complete[data_complete$oplcat == 'wo', ]$oplcat_re <- 'high'
data_complete$oplcat_re <- relevel(factor(data_complete$oplcat_re), ref = 'low')

data_complete %>%
  group_by(month, geslacht) %>%
  summarise(event = sum(event),
         total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = month, 
             y = log(-log(1-hazard)),
             col = geslacht)) +
  geom_point() +
  geom_smooth()


data_complete %>%
  group_by(month, lftdcat_re) %>%
  summarise(event = sum(event),
         total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = month, 
             y = log(-log(1-hazard)),
             col = lftdcat_re)) +
  geom_point() +
  geom_smooth()

data_complete %>%
  group_by(month, oplcat_re) %>%
  summarise(event = sum(event),
         total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = month, 
             y = log(-log(1-hazard)),
             col = oplcat_re)) +
  geom_point() +
  geom_smooth()



#Gompertz_Model_Demographics <- glm(formula = event ~ month + geslacht + lftdcat_re + oplcat_re,
#                               family = binomial(link = "cloglog"),
#                               data = data_complete)

Model_poly_Demographics <- glm(formula = event ~ poly(month, 4, raw=TRUE) + geslacht + lftdcat_re + oplcat_re,
                               family = binomial(link = "logit"),
                               data = data_complete)

#summary(Gompertz_Model_Demographics)
summary(Model_poly_Demographics)

#summ(Gompertz_Model_Demographics, exp = T) #exp = T means that we want exponentiated estimates
summ(Model_poly_Demographics, exp = T) #exp = T means that we want exponentiated estimates


# 3. Add UTAUT variables

data_complete %>%
  group_by(PE_UTAUT) %>%
  summarise(event = sum(event),
            total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = PE_UTAUT, y = hazard)) + #log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth(method = "lm")

data_complete %>%
  group_by(EE_UTAUT) %>%
  summarise(event = sum(event),
            total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = EE_UTAUT, y = hazard)) + #log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth(method = "lm")

data_complete %>%
  group_by(FC_UTAUT) %>%
  summarise(event = sum(event),
            total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = FC_UTAUT, y = hazard)) + #log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth(method = "lm")

data_complete %>%
  group_by(SI_UTAUT) %>%
  summarise(event = sum(event),
            total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = SI_UTAUT, y = hazard)) + #log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth(method = "lm")


#Gompertz_Model_UTAUT <- glm(formula = event ~ month + PE_UTAUT + EE_UTAUT + FC_UTAUT + SI_UTAUT + geslacht #+ lftdcat_re + oplcat_re,
#                               family = binomial(link = "cloglog"),
#                               data = data_complete)

Model_poly_UTAUT <- glm(formula = event ~ poly(month, 4, raw=TRUE) + PE_UTAUT + EE_UTAUT + FC_UTAUT + SI_UTAUT + geslacht + lftdcat_re + oplcat_re,
                               family = binomial(link = "logit"),
                               data = data_complete)

#summary(Gompertz_Model_UTAUT)
summary(Model_poly_UTAUT)

#summ(Gompertz_Model_UTAUT, exp = T) #exp = T means that we want exponentiated estimates
summ(Model_poly_UTAUT, exp = T) #exp = T means that we want exponentiated estimates


# 4. Add HBM variables

data_complete %>%
  group_by(HBM_PSus_self) %>%
  summarise(event = sum(event),
            total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = HBM_PSus_self, y = hazard)) + #log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth(method = "lm")


data_complete %>%
  group_by(HBM_PSev_self) %>%
  summarise(event = sum(event),
            total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = HBM_PSev_self, y = hazard)) + #log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth(method = "lm")


data_complete$HBM_selfefficacy_CoronaMelder = as.numeric(data_complete$HBM_selfefficacy_CoronaMelder)

data_complete %>%
  group_by(HBM_selfefficacy_CoronaMelder) %>%
  summarise(event = sum(event),
            total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = HBM_selfefficacy_CoronaMelder, y = hazard)) + #log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth(method = "lm")


data_complete$HBM_perceivedbenefits_CoronaMelder = as.numeric(data_complete$HBM_perceivedbenefits_CoronaMelder)

data_complete %>%
  group_by(HBM_perceivedbenefits_CoronaMelder) %>%
  summarise(event = sum(event),
            total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = HBM_perceivedbenefits_CoronaMelder, y = hazard)) + #log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth(method = "lm")


data_complete$HBM_barriers_CoronaMelder = as.numeric(data_complete$HBM_barriers_CoronaMelder)

data_complete %>%
  group_by(HBM_barriers_CoronaMelder) %>%
  summarise(event = sum(event),
            total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = HBM_barriers_CoronaMelder, y = hazard)) + #log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth(method = "lm")

data_complete$notifications_1


#Gompertz_Model_HBM <- glm(formula = event ~ month + PE_UTAUT + EE_UTAUT + FC_UTAUT + SI_UTAUT + HBM_PSus_self + HBM_PSev_self + HBM_selfefficacy_CoronaMelder + HBM_perceivedbenefits_CoronaMelder + HBM_barriers_CoronaMelder + geslacht + lftdcat_re + oplcat_re,
#                               family = binomial(link = "cloglog"),
#                               data = data_complete)

Model_poly_HBM <- glm(formula = event ~ poly(month, 4, raw=TRUE) + PE_UTAUT + EE_UTAUT + FC_UTAUT + SI_UTAUT + HBM_PSus_self + HBM_PSev_self + HBM_selfefficacy_CoronaMelder + HBM_perceivedbenefits_CoronaMelder + HBM_barriers_CoronaMelder + geslacht + lftdcat_re + oplcat_re,
                               family = binomial(link = "logit"),
                               data = data_complete)

#summary(Gompertz_Model_HBM)
summary(Model_poly_HBM)

#summ(Gompertz_Model_HBM, exp = T) #exp = T means that we want exponentiated estimates
summ(Model_poly_HBM, exp = T) #exp = T means that we want exponentiated estimates



# 5. Add contextual variables
data_complete %>%
  group_by(Beliefs_monitoring) %>%
  summarise(event = sum(event),
            total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = Beliefs_monitoring, y = hazard)) + #log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth(method = "lm")

data_complete %>%
  group_by(Beliefs_Conspiracy) %>%
  summarise(event = sum(event),
            total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = Beliefs_Conspiracy, y = hazard)) + #log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth(method = "lm")

data_complete %>%
  group_by(Beliefs_fearB) %>%
  summarise(event = sum(event),
            total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = Beliefs_fearB, y = hazard)) + #log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth(method = "lm")

data_complete %>%
  group_by(Beliefs_Society) %>%
  summarise(event = sum(event),
            total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = Beliefs_Society, y = hazard)) + #log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth(method = "lm")

data_complete %>%
  group_by(Beliefs_datasafety_5p) %>%
  summarise(event = sum(event),
            total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = Beliefs_datasafety_5p, y = hazard)) + #log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth(method = "lm")


data_complete$HBM_PSus_other2 <- as.numeric(data_complete$HBM_PSus_other2)

data_complete %>%
  group_by(HBM_PSus_other2) %>%
  summarise(event = sum(event),
            total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = HBM_PSus_other2, y = hazard)) + #log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth(method = "lm")

data_complete$HBM_PSev_other2 <- as.numeric(data_complete$HBM_PSev_other2)

data_complete %>%
  group_by(HBM_PSev_other2) %>%
  summarise(event = sum(event),
            total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = HBM_PSev_other2, y = hazard)) + #log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth(method = "lm")

data_complete %>%
  group_by(Beliefs_technologyperformance_5p) %>%
  summarise(event = sum(event),
            total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = Beliefs_technologyperformance_5p, y = hazard)) + #log(-log(1-hazard)))) +
  geom_point() +
  geom_smooth(method = "lm")

unique(data_wave1$Infectother)
data_complete$Infectother <- as.numeric(data_complete$Infectother)

# ===

f <- filter(data_complete, notifications_1 == 'Ja, 1 keer')$notifications
f <- filter(data_complete, notifications_1 == 'Nee')

f <- data_complete[data_complete$nomem_encr %in% filter(data_complete, notifications_1 == 'Ja, al meerdere keren')$nomem_encr,]

data_complete$notifications <- NA
data_complete <- mutate(data_complete, notifications = ifelse(notifications_1 == 'Ja, al meerdere keren' | notifications_1 == 'Ja, 1 keer', 'Ja', notifications))
data_complete <- mutate(data_complete, notifications = ifelse(notifications_1 == 'Nee', 'Nee', notifications))

nrow(filter(data_complete, is.na(notifications_1)))


#filter(data_complete, notifications_1 == 'Ja, 1 keer')$notifications <- 'Ja'
#filter(data_complete, notifications_1 == 'Ja, al meerdere keren')$notifications <- 'Ja'
#data_complete[data_complete$nomem_encr %in% filter(data_complete, notifications_1 == 'Ja, al meerdere keren')$nomem_encr,]$notifications <- 'Ja'
#data_complete[data_complete$nomem_encr %in% filter(data_complete, notifications_1 == 'Ja, 1 keer')$nomem_encr,]$notifications <- 'Ja'
#data_complete[data_complete$nomem_encr %in% filter(data_complete, notifications_1 == 'Nee')$nomem_encr,]$notifications <- 'Nee'


data_complete %>%
  group_by(month, notifications) %>%
  summarise(event = sum(event),
         total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = month, 
             y = log(-log(1-hazard)),
             col = notifications)) +
  geom_point() +
  geom_smooth()


data_complete$Infectother <- factor(data_complete$Infectother)

data_complete %>%
  group_by(month, Infectother) %>%
  summarise(event = sum(event),
         total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = month, 
             y = log(-log(1-hazard)),
             col = Infectother)) +
  geom_point() +
  geom_smooth()


#Gompertz_Model_Context <- glm(formula = event ~ month + PE_UTAUT + EE_UTAUT + FC_UTAUT + SI_UTAUT + HBM_PSus_self + HBM_PSev_self + HBM_selfefficacy_CoronaMelder + HBM_perceivedbenefits_CoronaMelder + HBM_barriers_CoronaMelder + Beliefs_monitoring + Beliefs_Conspiracy + Beliefs_fearB + Beliefs_Society + Beliefs_datasafety_5p + HBM_PSus_other2 + HBM_PSev_other2 + Beliefs_technologyperformance_5p + Infectother + geslacht + lftdcat_re + oplcat_re,
#                               family = binomial(link = "cloglog"),
#                               data = data_complete)

#Gompertz_Model_Context2 <- glm(formula = event ~ month + PE_UTAUT + EE_UTAUT + FC_UTAUT + SI_UTAUT + HBM_PSus_self + HBM_PSev_self + HBM_selfefficacy_CoronaMelder + HBM_perceivedbenefits_CoronaMelder + HBM_barriers_CoronaMelder + Beliefs_monitoring + Beliefs_Conspiracy + Beliefs_fearB + Beliefs_Society + Beliefs_datasafety_5p + HBM_PSus_other2 + HBM_PSev_other2 + Beliefs_technologyperformance_5p + Infectother + geslacht + lftdcat_re + oplcat_re,
#                               family = binomial(link = "logit"),
#                               data = data_complete)

#Gompertz_Model_nl_Context <- glm(formula = event ~ poly(month, 4) + PE_UTAUT + EE_UTAUT + FC_UTAUT + SI_UTAUT + HBM_PSus_self + HBM_PSev_self + HBM_selfefficacy_CoronaMelder + HBM_perceivedbenefits_CoronaMelder + HBM_barriers_CoronaMelder + Beliefs_monitoring + Beliefs_Conspiracy + Beliefs_fearB + Beliefs_Society + Beliefs_datasafety_5p + HBM_PSus_other2 + HBM_PSev_other2 + Beliefs_technologyperformance_5p + Infectother + geslacht + lftdcat_re + oplcat_re + wave,
#                               family = binomial(link = "cloglog"),
#                               data = data_complete)

Model_poly_Context <- glm(formula = event ~ poly(month, 4, raw=TRUE) + PE_UTAUT + EE_UTAUT + FC_UTAUT + SI_UTAUT + HBM_PSus_self + HBM_PSev_self + HBM_selfefficacy_CoronaMelder + HBM_perceivedbenefits_CoronaMelder + HBM_barriers_CoronaMelder + Beliefs_monitoring + Beliefs_Conspiracy + Beliefs_fearB + Beliefs_Society + Beliefs_datasafety_5p + HBM_PSus_other2 + HBM_PSev_other2 + Beliefs_technologyperformance_5p + Infectother + geslacht + lftdcat_re + oplcat_re,
                               family = binomial(link = "logit"),
                               data = data_complete)

#summary(Gompertz_Model_Context)
#summary(Gompertz_Model_Context2)
#summary(Gompertz_Model_nl_Context)
summary(Model_poly_Context)

#summ(Gompertz_Model_Context, exp = T) #exp = T means that we want exponentiated estimates
#summ(Gompertz_Model_Context2, exp = T) #exp = T means that we want exponentiated estimates
#summ(Gompertz_Model_nl_Context, exp = T) #exp = T means that we want exponentiated estimates
summ(Model_poly_Context, exp = T) #exp = T means that we want exponentiated estimates

anova(Gompertz_Model_Context, Gompertz_Model_Context2, test ="Chisq")


# Plotting the survival curve
plot(Gompertz_Model_Baseline)

  #filter(data_complete, event == 0 & )

# data_wave1_in$stopped_wave = 1
# data_wave2_in$stopped_wave = 2
# data_wave3_in$stopped_wave = 3
# data_wave4_in$stopped_wave = 4
# data_wave5_in$stopped_wave = 5
# data_wave6_in$stopped_wave = 6
# 
# test <- data_wave1_in[data_wave1_in$Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer",c("nomem_encr", "Awareness", "stopped_wave")]
# 
# test = setDT(test)
# 
# test <- rbind(test, data_wave2_in[data_wave2_in$Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer",c("nomem_encr", "Awareness", "stopped_wave")])
# 
# test <- rbind(test, data_wave3_in[data_wave3_in$Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer",c("nomem_encr", "Awareness", "stopped_wave")])
# 
# test <- rbind(test, data_wave4_in[data_wave4_in$Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer",c("nomem_encr", "Awareness", "stopped_wave")])
# 
# test <- rbind(test, data_wave5_in[data_wave5_in$Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer",c("nomem_encr", "Awareness", "stopped_wave")])
# 
# test <- rbind(test, data_wave6_in[data_wave6_in$Behavior_UTAUT == "Ik heb de CoronaMelder app in het verleden wel gebruikt maar op dit moment niet meer",c("nomem_encr", "Awareness", "stopped_wave")])
# 
# setkey(test, nomem_encr)
# test <- unique(test, by="nomem_encr")
# 
# test <- na.omit(test)
# 
# n <- test[test$stopped_wave == 6]



# Plot: gender
data_complete %>%
  group_by(month, geslacht) %>%
  summarise(event = sum(event),
         total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = month, 
             y = hazard,#log(hazard/(1-hazard)),
             col = geslacht)) +
  geom_point() +
  geom_smooth(se=F) + 
  scale_colour_discrete(name = 'Gender', labels = c('Male', 'Female')) +
  ylim(0, 1) + ylab('Hazard (chance of event)') + xlab ('Months of use')

  data_complete %>%
  group_by(month, event) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = event, col = geslacht)) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth(se=F) +
  scale_colour_discrete(name = 'Gender', labels = c('Male', 'Female')) +
  ylim(0, 1) + ylab('Hazard (chance of event)') + xlab ('Months of use')

# Plot: age
data_complete %>%
  group_by(month, lftdcat_re) %>%
  summarise(event = sum(event),
         total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = month, 
             y = hazard,#log(hazard/(1-hazard)),
             col = lftdcat_re)) +
  geom_point() +
  geom_smooth() + #se=F, method = loess, method.args = list(family = "symmetric")) + 
  scale_colour_discrete(name = 'Age category (years)', labels = c('17-34', '35-54', '55-64', '65-89')) +
  ylab('Hazard (chance of event)') + xlab ('Months of use')

  data_complete %>%
  group_by(month, event) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = event, col = lftdcat_re)) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth(se=F) +
  scale_colour_discrete(name = 'Age category (years)', labels = c('17-34', '35-54', '55-64', '65-89')) +
  ylim(0, 1) + ylab('Hazard (chance of event)') + xlab ('Months of use')

# Plot: level of education
data_complete %>%
  group_by(month, oplcat_re) %>%
  summarise(event = sum(event),
         total = n()) %>%
  mutate(hazard = event/total) %>%
  ggplot(aes(x = month, 
             y = hazard,#log(hazard/(1-hazard)),
             col = oplcat_re)) +
  geom_point() +
  geom_smooth(se=F) + #, method = loess, method.args = list(family = "symmetric")) + 
  scale_colour_discrete(name = 'Level of education', labels = c('Low', 'High', 'Middle')) +
  ylim(0, 1) + ylab('Hazard (chance of event)') + xlab ('Months of use')
  
  data_complete %>%
  group_by(month, event) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = event, col = oplcat_re)) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth(se=F) +
  scale_colour_discrete(name = 'Level of education', labels = c('Low', 'High', 'Middle')) +
  ylim(0, 1) + ylab('Hazard (chance of event)') + xlab ('Months of use')

  
# UTAUT: PE  
data_complete %>%
  group_by(month, as.factor(event)) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = PE_UTAUT, col = as.factor(event))) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth() +
  #geom_line() + 
  scale_colour_discrete(name = 'Status', labels = c('App user', 'Stopped using')) +
  ylim(1, 7) + ylab('UTAUT: Performance expectancy') + xlab ('Months')


# UTAUT: EE 
data_complete %>%
  group_by(month, as.factor(event)) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = EE_UTAUT, col = as.factor(event))) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth() +
  #geom_line() + 
  scale_colour_discrete(name = 'Status', labels = c('App user', 'Stopped using')) +
  ylim(1, 7) + ylab('UTAUT: Effort expectancy') + xlab ('Months')


# UTAUT: FC 
data_complete %>%
  group_by(month, as.factor(event)) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = FC_UTAUT, col = as.factor(event))) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth() +
  #geom_line() + 
  scale_colour_discrete(name = 'Status', labels = c('App user', 'Stopped using')) +
  ylim(1, 7) + ylab('UTAUT: Facilitating conditions') + xlab ('Months')


# UTAUT: SI 
data_complete %>%
  group_by(month, as.factor(event)) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = SI_UTAUT, col = as.factor(event))) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth() +
  #geom_line() + 
  scale_colour_discrete(name = 'Status', labels = c('App user', 'Stopped using')) +
  ylim(1, 7) + ylab('UTAUT: Social influence') + xlab ('Months')


# HBM: Perceived susceptibility 
data_complete %>%
  group_by(month, as.factor(event)) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = HBM_PSus_self, col = as.factor(event))) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth() +
  #geom_line() + 
  scale_colour_discrete(name = 'Status', labels = c('App user', 'Stopped using')) +
  ylim(1, 7) + ylab('HBM: Perceived susceptibility') + xlab ('Months')


# HBM: Perceived severity 
data_complete %>%
  group_by(month, as.factor(event)) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = HBM_PSev_self, col = as.factor(event))) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth() +
  #geom_line() + 
  scale_colour_discrete(name = 'Status', labels = c('App user', 'Stopped using')) +
  ylim(1, 7) + ylab('HBM: Perceived severity') + xlab ('Months')


# HBM: Self-efficacy 
data_complete %>%
  group_by(month, as.factor(event)) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = HBM_selfefficacy_CoronaMelder, col = as.factor(event))) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth() +
  #geom_line() + 
  scale_colour_discrete(name = 'Status', labels = c('App user', 'Stopped using')) +
  ylim(1, 7) + ylab('HBM: Self-efficacy') + xlab ('Months')


# HBM: Perceived benefits
data_complete %>%
  group_by(month, as.factor(event)) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = HBM_perceivedbenefits_CoronaMelder, col = as.factor(event))) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth() +
  #geom_line() + 
  scale_colour_discrete(name = 'Status', labels = c('App user', 'Stopped using')) +
  ylim(1, 7) + ylab('HBM: Perceived benefits') + xlab ('Months')


# HBM: Perceived barriers
data_complete %>%
  group_by(month, as.factor(event)) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = HBM_barriers_CoronaMelder, col = as.factor(event))) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth() +
  #geom_line() + 
  scale_colour_discrete(name = 'Status', labels = c('App user', 'Stopped using')) +
  ylim(1, 7) + ylab('HBM: Perceived barriers') + xlab ('Months')


# Context: Monitoring beliefs
data_complete %>%
  group_by(month, as.factor(event)) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = Beliefs_monitoring, col = as.factor(event))) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth() +
  #geom_line() + 
  scale_colour_discrete(name = 'Status', labels = c('App user', 'Stopped using')) +
  ylim(1, 5) + ylab('Monitoring beliefs') + xlab ('Months')


# Context: Conspiracy beliefs
data_complete %>%
  group_by(month, as.factor(event)) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = Beliefs_Conspiracy, col = as.factor(event))) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth() +
  #geom_line() + 
  scale_colour_discrete(name = 'Status', labels = c('App user', 'Stopped using')) +
  ylim(1, 5) + ylab('Conspiracy beliefs') + xlab ('Months')

# Context: Fear beliefs
data_complete %>%
  group_by(month, as.factor(event)) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = Beliefs_fearB, col = as.factor(event))) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth() +
  #geom_line() + 
  scale_colour_discrete(name = 'Status', labels = c('App user', 'Stopped using')) +
  ylim(1, 7) + ylab('Fear beliefs') + xlab ('Months')

# Context: Societal beliefs
data_complete %>%
  group_by(month, as.factor(event)) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = Beliefs_Society, col = as.factor(event))) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth() +
  #geom_line() + 
  scale_colour_discrete(name = 'Status', labels = c('App user', 'Stopped using')) +
  ylim(1, 7) + ylab('Societal beliefs') + xlab ('Months')


# Context: Data safety
data_complete %>%
  group_by(month, as.factor(event)) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = Beliefs_datasafety_5p, col = as.factor(event))) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth() +
  #geom_line() + 
  scale_colour_discrete(name = 'Status', labels = c('App user', 'Stopped using')) +
  ylim(1, 5) + ylab('Data safety') + xlab ('Months')


# Context: Perceived susceptibility (others)
data_complete %>%
  group_by(month, as.factor(event)) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = HBM_PSus_other2, col = as.factor(event))) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth() +
  #geom_line() + 
  scale_colour_discrete(name = 'Status', labels = c('App user', 'Stopped using')) +
  ylim(1, 7) + ylab('Perceived susceptibility (others)') + xlab ('Months')


# Context: Perceived severity (others)
data_complete %>%
  group_by(month, as.factor(event)) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = HBM_PSev_other2, col = as.factor(event))) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth() +
  #geom_line() + 
  scale_colour_discrete(name = 'Status', labels = c('App user', 'Stopped using')) +
  ylim(1, 7) + ylab('Perceived severity (others)') + xlab ('Months')


# Context: Technology beliefs
data_complete %>%
  group_by(month, as.factor(event)) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = Beliefs_technologyperformance_5p, col = as.factor(event))) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth() +
  #geom_line() + 
  scale_colour_discrete(name = 'Status', labels = c('App user', 'Stopped using')) +
  ylim(1, 5) + ylab('Technology beliefs') + xlab ('Months')

# Context: Others infected
  data_complete %>%
  group_by(month, event) %>%
  #summarise(event = sum(event),
  #          total = n()) %>%
  #mutate(hazard = event/total) %>%
  ggplot(aes(x = month, y = event, col = Infectother)) + #log(-log(1-hazard)))) +
  #geom_point() +
  geom_smooth(se=F) +
  scale_colour_discrete(name = 'Others infected?', labels = c('No', 'Yes')) +
  ylim(0, 1) + ylab('Hazard (chance of event)') + xlab ('Months')

 ```
```{=openxml}
<w:p><w:r><w:br w:type="page"/></w:r></w:p>
```
